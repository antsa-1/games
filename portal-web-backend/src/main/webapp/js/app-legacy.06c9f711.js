(function(){"use strict";var e={1707:function(e,t,n){n(6992),n(8674),n(9601),n(7727);var a=n(8061),i=n(6252),o={class:"container"},s=(0,i._)("header",null,[(0,i._)("h2",null,"Welcomes you!")],-1),r=(0,i._)("footer",null,null,-1);function l(e,t,n,a,l,c){var u=(0,i.up)("NavbarTop"),h=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)("div",o,[s,(0,i.Wm)(u),(0,i.Wm)(h),r])}var c=n(8534),u=(n(5666),n(3157),n(6612)),h={class:"navbar navbar-expand-lg navbar-light rounded",style:{"background-color":"#BC8F8F"}},d={key:0,class:"container-fluid"},p=(0,i._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,i._)("span",{class:"navbar-toggler-icon"})],-1),m={id:"navbarSupportedContent",class:"collapse navbar-collapse"},g={class:"navbar-nav me-auto mb-2 mb-lg-0"},b={class:"nav-item"},f=(0,i.Uk)("Home"),v={class:"nav-item"},y=(0,i.Uk)("Games"),T={key:0,class:"nav-item"},w=(0,i.Uk)("Registration"),k={class:"nav-item"},x=(0,i.Uk)(" Terms and conditions "),C={class:"nav-item"},P=(0,i._)("i",{class:"bi bi-megaphone"},null,-1),B=(0,i.Uk)(" Top lists "),S={class:"nav-item"},I=(0,i.Uk)(" Feedback "),_={class:"nav-item"},L=(0,i.Uk)(" Game instructions "),D={class:"navbar-nav ms-auto"},R={class:"nav-item dropdown"},M=(0,i._)("i",{class:"bi bi-person-fill"},null,-1),A=(0,i.Uk)(" User "),N=[M,A],E={key:0},O=(0,i.Uk)("Show profile"),G={key:1},H=(0,i.Uk)("Logout"),V={key:2},$=(0,i.Uk)(" Login "),U={key:1,class:"container-fluid"},q=(0,i._)("div",{class:"spinner-border",role:"status"},[(0,i._)("span",{class:"sr-only"})],-1),z=[q];function W(e,t,n,a,o,s){var r=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("nav",h,[e.loading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",d,[p,(0,i._)("div",m,[(0,i._)("ul",g,[(0,i._)("li",b,[(0,i.Wm)(r,{class:"nav-link",to:{name:"Home"}},{default:(0,i.w5)((function(){return[f]})),_:1})]),(0,i._)("li",v,[(0,i.Wm)(r,{class:"nav-link",to:{name:"Lobby"}},{default:(0,i.w5)((function(){return[y]})),_:1})]),e.authenticated?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("li",T,[(0,i.Wm)(r,{class:"nav-link",to:{name:"Registration"}},{default:(0,i.w5)((function(){return[w]})),_:1})])),(0,i._)("li",k,[(0,i.Wm)(r,{class:"nav-link",to:{name:"Info"}},{default:(0,i.w5)((function(){return[x]})),_:1})]),(0,i._)("li",C,[(0,i.Wm)(r,{class:"nav-link",to:{name:"TopLists"}},{default:(0,i.w5)((function(){return[P,B]})),_:1})]),(0,i._)("li",S,[(0,i.Wm)(r,{class:"nav-link",to:{name:"Feedback"}},{default:(0,i.w5)((function(){return[I]})),_:1})]),(0,i._)("li",_,[(0,i.Wm)(r,{class:"nav-link",to:{name:"Instructions"}},{default:(0,i.w5)((function(){return[L]})),_:1})])]),(0,i._)("ul",D,[(0,i._)("li",R,[(0,i._)("a",{class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button",onClick:t[0]||(t[0]=function(t){return e.toggle=!e.toggle}),"data-bs-toggle":"dropdown","aria-expanded":"false"},N),(0,i._)("ul",{class:(0,u.C_)(["dropdown-menu ms-auto",{show:e.toggle}]),"aria-labelledby":"navbarDropdown",onClick:t[1]||(t[1]=function(t){return e.toggle=!e.toggle})},[e.authenticated?((0,i.wg)(),(0,i.iD)("li",E,[(0,i.Wm)(r,{class:"dropdown-item",to:{name:"Profile",params:{selectedName:e.userName}}},{default:(0,i.w5)((function(){return[O]})),_:1},8,["to"])])):(0,i.kq)("",!0),e.authenticated?((0,i.wg)(),(0,i.iD)("li",G,[(0,i.Wm)(r,{onClick:e.logout,class:"dropdown-item",to:{name:"Login"}},{default:(0,i.w5)((function(){return[H]})),_:1},8,["onClick"])])):(0,i.kq)("",!0),e.authenticated?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("li",V,[(0,i.Wm)(r,{class:"dropdown-item",to:{name:"Login"}},{default:(0,i.w5)((function(){return[$]})),_:1})]))],2)])])])])),e.loading?((0,i.wg)(),(0,i.iD)("div",U,z)):(0,i.kq)("",!0)])}n(8309);var F={data:function(){return{token:null}},computed:{authenticated:function(){var e=this.$store.getters.user;return!(!e||!e.token||e.token.startsWith("null")||e.token.startsWith("Anom:"))},userName:function(){var e;return null===(e=this.$store.getters.user)||void 0===e?void 0:e.name},user:function(){return this.$store.getters.user}},created:function(){},methods:{getToken:function(){var e=this.$store.getters.user;return e?e.token:null},logout:function(){return this.$store.dispatch("logout",this.$store.getters.user)}}},Y=(0,i.aZ)({name:"NavbarTop",mixins:[F],props:{msg:String},data:function(){return{toggle:!1}},created:function(){},computed:{loading:function(){return this.$store.getters.loadingStatus}},methods:{}}),Q=n(3744);const Z=(0,Q.Z)(Y,[["render",W]]);var J=Z,X=(0,i.aZ)({name:"Games",components:{NavbarTop:J},mixins:[F],data:function(){return{title:""}},created:function(){var e=this;return(0,c.Z)(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.user){t.next=7;break}return n=sessionStorage.getItem("userName"),a=sessionStorage.getItem("token"),i={name:n,token:a,webSocket:null},n&&!n.startsWith("Anon")&&{name:n,token:a,webSocket:null},t.next=7,e.$store.dispatch("setUser",i);case 7:case"end":return t.stop()}}),t)})))()},methods:{}});const j=(0,Q.Z)(X,[["render",l]]);var K=j,ee={key:0,class:"row"},te={class:"row"},ne={class:"col-md-6 offset-md-3 alert alert-info"},ae=(0,i._)("br",null,null,-1),ie={key:1,class:"row"},oe={class:"col m-2"},se=(0,i._)("h3",null,"Login ",-1),re=(0,i.Uk)(" UserName: "),le=(0,i._)("br",null,null,-1),ce={key:2,class:"row"},ue={class:"col m-2"},he=(0,i.Uk)(" Password: "),de=["disabled"],pe={key:3,class:"row d-inline-flex p-2 alert-danger",role:"alert"};function me(e,t,n,o,s,r){return(0,i.wg)(),(0,i.iD)(i.HY,null,[e.authenticated?((0,i.wg)(),(0,i.iD)("div",ee,[(0,i._)("div",te,[(0,i._)("div",ne,[(0,i.Uk)(" Welcome "+(0,u.zw)(e.userName)+" ",1),ae])])])):(0,i.kq)("",!0),e.authenticated?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",ie,[(0,i._)("div",oe,[se,(0,i._)("div",null,[re,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.usrNameTemp=t}),class:"p-3",type:"text"},null,512),[[a.nr,e.usrNameTemp]]),le])])])),e.authenticated?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",ce,[(0,i._)("div",ue,[he,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.usrPwTemp=t}),class:"p-3",type:"password"},null,512),[[a.nr,e.usrPwTemp]]),(0,i._)("div",null,[(0,i._)("button",{onClick:t[2]||(t[2]=function(){return e.login&&e.login.apply(e,arguments)}),disabled:e.isLoginButtonDisabled},"Login",8,de)])])])),e.errorFromLogin?((0,i.wg)(),(0,i.iD)("div",pe," Login error occured! ")):(0,i.kq)("",!0)],64)}n(8862),n(1539);var ge=(0,i.aZ)({name:"Login",mixins:[F],props:{token:String},data:function(){return{loginToken:null,usrNameTemp:null,usrPwTemp:null,loginError:null,loginRequestOnTheFly:!1}},computed:{isLoginButtonDisabled:function(){return!!this.loginRequestOnTheFly||(!this.usrNameTemp||!this.usrPwTemp||(this.usrNameTemp.length<1||this.usrPwTemp.length<1))},errorFromLogin:function(){return null!=this.loginError}},created:function(){},methods:{login:function(){var e=this;this.logout().then((function(){e.loginError=null,e.loginRequestOnTheFly=!0;var t={method:"POST",headers:{"Content-Type":"application/json",Authorization:null},body:JSON.stringify({userName:e.usrNameTemp,password:e.usrPwTemp})},n="http://35.217.7.146/portal/api/user/login";e.$store.dispatch("setLoadingStatus",!0),fetch(n,t).then((function(t){return e.resetLoginData(),200!==t.status?Promise.reject("error in login"):t.json()})).then((function(t){var n={name:t.name,token:t.activeLoginId};e.$store.dispatch("setUser",n)}),(function(){e.loginError=!0})).finally((function(){e.loginRequestOnTheFly=!1,e.$store.dispatch("setLoadingStatus",!1)}))}))},resetLoginData:function(){this.usrName=null,this.pw=null}}});const be=(0,Q.Z)(ge,[["render",me]]);var fe=be,ve={class:"row mt-3"},ye={class:"col-xs-12 col-sm-4 mt-3 mt-md-0 pt-3"},Te=(0,i._)("span",{class:"fw-bold"}," Players ",-1),we={class:"list-group"},ke=["onClick"],xe={class:"float-start"},Ce={key:0,xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",fill:"currentColor",class:"bi bi-arrow-left",viewBox:"0 0 16 16"},Pe=(0,i._)("path",{"fill-rule":"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"},null,-1),Be=[Pe],Se={key:0,class:"bi bi-star float-end tooltipselector",title:"ConnectFour ranking"},Ie={key:1,class:"bi bi-suit-diamond float-end tooltipselector",title:"TicTacToe ranking"},_e={class:"col-xs-12 col-sm-4 mt-3 mt-md-0"},Le={class:"row"},De={class:"col-xs-6"},Re=(0,i._)("span",{class:"fw-bold"}," Tables ",-1),Me={class:"float-end"},Ae={key:0,type:"button",class:"btn btn-primary w-30 float-start","data-bs-toggle":"modal","data-bs-target":"#createTableModal"},Ne={class:"row"},Ee={key:0,class:"table"},Oe=(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",{scope:"col"},"Table"),(0,i._)("th",{scope:"col"},"Board"),(0,i._)("th",{scope:"col"},"Playing"),(0,i._)("th",{scope:"col"},"Starter"),(0,i._)("th",{scope:"col"},"Time"),(0,i._)("th",{scope:"col"},"Action")])],-1),Ge={scope:"row"},He={key:0},Ve=["disabled","onClick"],$e=["onClick"],Ue={key:2},qe={key:1,class:"col fw-bold"},ze=(0,i._)("span",{class:"float-start"}," No tables at the moment. ",-1),We=[ze],Fe={class:"modal fade",id:"createTableModal",tabindex:"-1","aria-labelledby":"createTableModalLabel","aria-hidden":"true"},Ye={class:"modal-dialog"},Qe={class:"modal-content"},Ze=(0,i._)("div",{class:"modal-header"},[(0,i._)("h5",{class:"modal-title",id:"createTableModalLabel"},"Create table"),(0,i._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Je={class:"modal-body col-xs-12"},Xe={class:"",role:"group","aria-label":"Select game",id:"select-game"},je={value:0,key:0},Ke=["value"],et={class:""},tt={key:0,class:"",id:"v-model-select-dynamic"},nt={value:"0",key:0},at=["value"],it={class:"form-check",id:"computer_selection"},ot=(0,i._)("label",{class:"",for:"computerSelection"},"Play against computer",-1),st={class:"form-check",id:"only_registered"},rt=(0,i._)("label",{class:"",for:"onlyRegistered"},"Play only against registered",-1),lt={key:0,class:"form-check",id:"random_starter"},ct=(0,i._)("label",{class:"",for:"randomStarter"},"Random starter",-1),ut={key:0},ht=(0,i.Uk)(" Time control "),dt=["value"],pt={class:"modal-footer justify-content-between"},mt=(0,i._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1),gt=["disabled"];function bt(e,t,n,o,s,r){var l=this;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",ve,[(0,i._)("div",ye,[Te,(0,i._)("ul",we,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.users,(function(t,n){return(0,i.wg)(),(0,i.iD)("li",{key:t.name,onClick:function(n){return e.openProfile(t.name)},class:(0,u.C_)(["list-group-item bg-success p-2 text-dark",[n%2==0?"bg-opacity-25":" bg-opacity-10",t.name.startsWith("Anonym")?"":"games-profile-link"]])},[(0,i._)("div",xe,[(0,i.Uk)((0,u.zw)(t.name)+" ",1),t.name===e.userName?((0,i.wg)(),(0,i.iD)("svg",Ce,Be)):(0,i.kq)("",!0)]),t.rankingConnectFour>0?((0,i.wg)(),(0,i.iD)("i",Se,"  "+(0,u.zw)(e.fixVal(t.rankingConnectFour))+"  ",1)):(0,i.kq)("",!0),t.rankingTictactoe>0?((0,i.wg)(),(0,i.iD)("i",Ie,"  "+(0,u.zw)(e.fixVal(t.rankingTictactoe))+"  ",1)):(0,i.kq)("",!0)],10,ke)})),128))])]),(0,i._)("div",_e,[(0,i._)("div",Le,[(0,i._)("div",De,[Re,(0,i._)("span",Me,[e.hasCreatedTable?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",Ae," Create table ")),e.isRemoveTableButtonVisible?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t[0]||(t[0]=function(t){return e.removeTable()}),type:"button",class:"btn btn-primary bg-danger w-30 float-start"}," Remove table ")):(0,i.kq)("",!0)])])]),(0,i._)("div",Ne,[e.tablesExist?((0,i.wg)(),(0,i.iD)("table",Ee,[Oe,(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.tables,(function(t){var n;return(0,i.wg)(),(0,i.iD)("tr",{key:t.id},[(0,i._)("td",Ge,(0,u.zw)(e.getTableGameShortDesc(t.gameMode.id)),1),(0,i._)("td",null,(0,u.zw)(e.getBoardDesc(t)),1),(0,i._)("td",null,(0,u.zw)(t.playerA.name)+" - "+(0,u.zw)(null===(n=t.playerB)||void 0===n?void 0:n.name),1),(0,i._)("td",null,(0,u.zw)(t.randomizeStarter?"?":"fixed"),1),(0,i._)("td",null,(0,u.zw)(l.getTimeControl(t))+"s ",1),(0,i._)("td",null,[e.hasCreatedTable?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("section",He,[e.playButtonVisible(t)?((0,i.wg)(),(0,i.iD)("button",{key:0,disabled:!e.createTableButtonVisible,onClick:function(n){return e.play(t)},type:"button",class:"btn btn-primary w-30 float-start"}," Play ",8,Ve)):(0,i.kq)("",!0),t.playerA&&t.playerB?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:function(n){return e.watchTable(t)},type:"button",class:"btn btn-primary w-30 float-end"}," Watch ",8,$e)):l.authenticated||e.playButtonVisible(t)?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("span",Ue,"Requires login to play"))]))])])})),128))])])):((0,i.wg)(),(0,i.iD)("div",qe,We))])])]),(0,i._)("div",Fe,[(0,i._)("div",Ye,[(0,i._)("div",Qe,[Ze,(0,i._)("div",Je,[(0,i._)("div",Xe,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selectedGame=t}),onChange:t[2]||(t[2]=function(){return e.onSelectedGameChange&&e.onSelectedGameChange.apply(e,arguments)})},[((0,i.wg)(),(0,i.iD)("option",je," Select game ")),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.games,(function(e){return(0,i.wg)(),(0,i.iD)("option",{value:e.gameId,key:e.id},(0,u.zw)(e.name),9,Ke)})),128))],544),[[a.bM,e.selectedGame]])]),(0,i._)("div",et,["0"!==e.selectedGame?((0,i.wg)(),(0,i.iD)("div",tt,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.selectedGameMode=t})},[((0,i.wg)(),(0,i.iD)("option",nt," Select variant ")),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.gameModes,(function(e){return(0,i.wg)(),(0,i.iD)("option",{value:e.id,key:e.id},(0,u.zw)(e.name),9,at)})),128))],512),[[a.bM,e.selectedGameMode]])])):(0,i.kq)("",!0)]),(0,i._)("div",it,[(0,i.wy)((0,i._)("input",{class:"",type:"checkbox",id:"computerSelection",onChange:t[4]||(t[4]=function(){return e.onComputerSelectionChange&&e.onComputerSelectionChange.apply(e,arguments)}),"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.playAgainstComputerChecked=t})},null,544),[[a.e8,e.playAgainstComputerChecked]]),ot]),(0,i._)("div",st,[(0,i.wy)((0,i._)("input",{class:"",type:"checkbox",id:"onlyRegistered","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.onlyRegistered=t})},null,512),[[a.e8,e.onlyRegistered]]),rt]),3===e.selectedGame?((0,i.wg)(),(0,i.iD)("div",lt,[(0,i.wy)((0,i._)("input",{class:"",type:"checkbox",id:"randomStarter","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.randomStarterChecked=t})},null,512),[[a.e8,e.randomStarterChecked]]),ct])):(0,i.kq)("",!0),(0,i._)("div",null,[3===e.selectedGame?((0,i.wg)(),(0,i.iD)("div",ut,[ht,(0,i._)("div",null,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.selectedTimeControl=t}),onChange:t[9]||(t[9]=function(){return e.timeControl&&e.timeControl.apply(e,arguments)})},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.getTimeControls(),(function(e){return(0,i.wg)(),(0,i.iD)("option",{value:e.id,key:e.id},(0,u.zw)(e.seconds)+" seconds ",9,dt)})),128))],544),[[a.bM,e.selectedTimeControl]])])])):(0,i.kq)("",!0)])]),(0,i._)("div",pt,[mt,(0,i._)("button",{disabled:e.modalCreateTableDisabled,onClick:t[10]||(t[10]=function(){return e.createTable&&e.createTable.apply(e,arguments)}),type:"button","data-bs-dismiss":"modal",class:"btn btn-primary"}," Create table ",8,gt)])])])])],64)}var ft,vt,yt;n(7327),n(2222),n(9714);(function(e){e["O"]="O",e["X"]="X"})(ft||(ft={})),function(e){e["GAME"]="G",e["RESIGNITION"]="R"}(vt||(vt={})),function(e){e[e["WIN_BY_PLAY"]=1]="WIN_BY_PLAY",e[e["WIN_BY_TIME"]=2]="WIN_BY_TIME",e[e["WIN_BY_RESIGNATION"]=3]="WIN_BY_RESIGNATION",e[e["WIN_BY_DISCONNECT"]=4]="WIN_BY_DISCONNECT",e[e["DRAW"]=5]="DRAW",e[e["LEFT_TABLE"]=6]="LEFT_TABLE"}(yt||(yt={}));n(6977);var Tt={data:function(){return{token:null}},computed:{},created:function(){},methods:{convertInstantToDate:function(e){return new Date(e).toLocaleDateString()},convertInstantToTime:function(e){return new Date(e).toLocaleTimeString()},convertResultToText:function(e){var t=yt[e];return t.toLowerCase()},getRankingChange:function(e,t){if(e&&t){var n=t>=e?"-":"+",a=Math.abs(e-t),i=n.concat(a.toFixed());return i}},fixVal:function(e){return e.toFixed()}}},wt={data:function(){return{token:null}},computed:{resignButtonDisabled:function(){this.$store.getters.theTable;return!!this.watch||(!(!this.theTable||this.theTable.playerInTurn)||this.theTable.playerInTurn.name!==this.userName)},rematchButtonEnabled:function(){var e=this.$store.getters.theTable;return!this.watch&&null===e.playerInTurn},resignButtonVisible:function(){var e,t,n,a;return this.userName===(null===(e=this.theTable)||void 0===e||null===(t=e.playerA)||void 0===t?void 0:t.name)||this.userName===(null===(n=this.theTable)||void 0===n||null===(a=n.playerB)||void 0===a?void 0:a.name)},theTable:function(){return this.$store.getters.theTable}},timeLeft:function(){return this.secondsLeft},theTable:function(){return this.$store.getters.theTable},watchers:function(){return this.$store.getters.theTable.watchers},created:function(){var e,t;(null===(e=this.theTable)||void 0===e||null===(t=e.playerInTurn)||void 0===t?void 0:t.name)===this.userName&&(this.startTime=120)},methods:{stopReducer:function(){clearInterval(this.redurcerInterval),this.secondsLeft=null},playMoveNotification:function(){if(this.soundOn){var e=new window.AudioContext,t=e.createOscillator();t.type="sine",t.frequency.setValueAtTime(446,e.currentTime),t.connect(e.destination),t.start(),setTimeout((function(){t.stop()}),250)}},removeMouseListeners:function(){this.canvas.removeEventListener("click",this.handleClick,!1)},disableBoard:function(){console.log("disable")},rematch:function(){var e={title:"REMATCH",message:""};this.user.webSocket.send(JSON.stringify(e))},resign:function(){var e={title:"RESIGN",message:this.tablea};this.user.webSocket.send(JSON.stringify(e))},leaveTable:function(){var e,t,n={title:"LEAVE_TABLE",message:this.theTable.tableId};null===this||void 0===this||null===(e=this.user)||void 0===e||null===(t=e.webSocket)||void 0===t||t.send(JSON.stringify(n)),this.$store.dispatch("clearTable")},openTable:function(e){this.$router.push({name:this.getTableName(e.gameMode.gameNumber),id:e.tableId})},openWatcherTable:function(e){this.$router.push({name:this.getTableName(e.gameMode.gameNumber),id:e.tableId,params:{watch:"1"}})},getTableName:function(e){return 1===e?"TableTicTacToe":2===e?"TableConnectFour":3===e?"PoolTable":void 0},getTimeControls:function(){return[{id:0,seconds:120},{id:1,seconds:90},{id:2,seconds:60},{id:3,seconds:45},{id:4,seconds:30},{id:5,seconds:20}]},isPlayerInTurn:function(e){return this.theTable.playerInTurn.name===e},isTurnChange:function(e){return this.$store.getters.playerInTurn.name!==e},isTurnChangeToMe:function(e){return e.playerInTurn.name===this.userName&&this.$store.getters.playerInTurn.name!==this.userName},isTurnChangeFromMe:function(e){return e.playerInTurn.name!==this.userName&&this.$store.getters.playerInTurn.name===this.userName},isTurnChangeToMe2:function(e){return console.log("isTurnChangeToMe2 nextPlayer:"+e+"  storePlayerinInTurn "+this.$store.getters.playerInTurn.name+"  myName:"+this.userName),e===this.userName&&this.$store.getters.playerInTurn.name!==this.userName},shouldChangeTurn:function(e){return!!this.$store.getters.playerInTurn&&this.$store.getters.playerInTurn.name!==e.name},changeTurnIfRequired:function(e){var t=this;return(0,c.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.shouldChangeTurn(e)){n.next=3;break}return n.next=3,t.$store.dispatch("changeTurn",e);case 3:case"end":return n.stop()}}),n)})))()},isMe:function(e){return this.userName===e},isMyTurnInStore:function(){var e,t;return(null===(e=this.theTable)||void 0===e||null===(t=e.playerInTurn)||void 0===t?void 0:t.name)===this.userName},playNotificationSound:function(){var e=new window.AudioContext,t=e.createOscillator();t.type="sine",t.frequency.setValueAtTime(446,e.currentTime),t.connect(e.destination),t.start(),setTimeout((function(){t.stop()}),0)}}},kt=n(2078),xt=(n(5505),n(7714),n(2801),n(1174),["image","color"]),Ct=["image","color"],Pt={mixins:[F,wt],data:function(){return{p:0}},computed:{},created:function(){},methods:{sendPocketSelection:function(e){e=null===e?0:e;var t={title:"POOL_SELECT_POCKET",message:this.theTable.tableId,pool:{selectedPocket:e}};console.log("*** Sending pocket selection to server"+JSON.stringify(t)),this.user.webSocket.send(JSON.stringify(t))},hb:function(e,t,n){var a={x:e,y:t},i={position:a},o={title:"POOL_HANDBALL",message:this.theTable.tableId,pool:{cueBall:i,canvas:{x:n.width,y:n.height}}};console.log("*** Sending handball to server"+JSON.stringify(o)),this.user.webSocket.send(JSON.stringify(o))},sendTurn:function(e,t,n){var a={title:"POOL_PLAY_TURN",message:this.theTable.tableId,pool:{cue:this.prepareTransfer(e),cueBall:this.prepareTransfer(t),canvas:{x:n.width,y:n.height}}};console.log("*** Sending turn to server"+JSON.stringify(a)),this.user.webSocket.send(JSON.stringify(a))},sp:function(e,t,n){var a={title:"POOL_UPDATE",message:this.theTable.tableId,pool:{cue:this.prepareTransfer(e),cueBall:this.prepareTransfer(t),canvas:{x:n.width,y:n.height}}};this.user.webSocket.send(JSON.stringify(a))},prepareHandBall:function(e){e.image,e.color;var t=(0,kt.Z)(e,xt);return t},prepareTransfer:function(e){e.image,e.color;var t=(0,kt.Z)(e,Ct);return t},t:function(e,t,n,a,i){var o=this;this.p||(this.p=!0,setTimeout((function(){e(n,a,i),o.p=atob("dHJ1ZQ==")<"m"&&"YmFzZTY0IGlzIG5vIGVuY3J5cHRpb24gCg=="}),t))},isHandBall:function(e){return"HANDBALL"===e.pool.turnResult},isOngoingGame:function(){return!!this.theTable&&!!this.theTable.playerInTurn},getClosestPocket:function(e){return e.offsetY<this.canvas.height/2?e.offsetX<this.canvas.width/3?0:e.offsetX<.66*this.canvas.width?1:2:e.offsetX<this.canvas.width/3?5:e.offsetX<.66*this.canvas.width?4:3}}},Bt=(0,i.aZ)({name:"Lobby",mixins:[F,Tt,wt,Pt],data:function(){return{createTableButtonVisible:!0,watchTableButtonDisabled:!1,removeTableButtonVisible:!1,selectedGame:"0",selectedGameMode:"0",selectedTimeControl:0,playAgainstComputerChecked:!1,randomStarterChecked:!1,onlyRegistered:!1,computerLevel:"0"}},computed:{users:function(){return this.$store.getters.users},tables:function(){return this.$store.getters.tables},games:function(){return this.$store.getters.games},gameModes:function(){return 1===this.selectedGame?this.$store.getters.games.filter((function(e){return 1===e.gameId}))[0].gameModes:2===this.selectedGame?this.$store.getters.games.filter((function(e){return 2===e.gameId}))[0].gameModes:3===this.selectedGame?this.$store.getters.games.filter((function(e){return 3===e.gameId}))[0].gameModes:void 0},modalCreateTableDisabled:function(){return"0"===this.selectedGameMode},tablesExist:function(){return this.$store.getters.tables.length>0},hasCreatedTable:function(){var e=this.$store.getters.tables[0];return!(!e||!e.playerA)&&e.playerA.name===this.userName},isRemoveTableButtonVisible:function(){var e=this.$store.getters.tables[0];return!(!e||!e.playerA)&&e.playerA.name===this.userName}},created:function(){this.user&&!this.user.webSocket&&this.connect(this.user.token)},methods:{connect:function(e){var t=this,n=new WebSocket("ws://35.217.7.146:80/games/ws");n.onopen=function(e){var a="LOGIN",i={title:a,message:t.user.token},o=(JSON.stringify(i),JSON.stringify(i));n.send(o)},n.onmessage=function(e){var a=JSON.parse(e.data);switch(a.title){case"LOGIN":var i={name:a.to,token:a.token,webSocket:n};t.$store.dispatch("setUser",i).then((function(){t.$store.dispatch("setUsers",a.players),t.$store.dispatch("setGames",a.games),t.$store.dispatch("setTables",a.tables)}));break;case"CREATE_TABLE":t.$store.dispatch("addTable",a.table),a.table.playerA.name===t.userName&&(t.createTableButtonVisible=!1,t.removeTableButtonVisible=!0);break;case"REMOVE_PLAYER":t.$store.dispatch("leaveTable",a.who.name).then((function(){t.$store.dispatch("removePlayer",a.who),a.table&&t.$store.dispatch("removeTable",a.table)}));break;case"REMOVE_TABLE":t.$store.dispatch("removeTable",a.table);var o=a.table;o.playerA&&o.playerA.name===t.userName&&(t.createTableButtonVisible=!0,t.removeTableButtonVisible=!1);break;case"NEW_PLAYER":t.$store.dispatch("addPlayer",a.who);break;case"START_GAME":t.$store.dispatch("startGame",a.table).then((function(){var e=a.table;e.playerA.name!==t.userName&&e.playerB.name!==t.userName||(e.playerA.wins=0,e.playerB.wins=0,t.createTableButtonVisible=!1,t.removeTableButtonVisible=!1,t.watchTableButtonVisible=!1,t.$store.dispatch("selectTable",a.table).then((function(){t.openTable(a.table)})))}));break;case"MOVE":var s={x:a.x,y:a.y,coordinates:a.x.toString().concat(a.y.toString()),token:a.token};t.$store.dispatch("move",s),t.$store.dispatch("changeTurn",a.table.playerInTurn);break;case"WATCH":console.log("watch arrived selecting table "+a.table),t.$store.dispatch("selectTable",a.table).then((function(){t.openWatcherTable(a.table)}));break;case"ADD_WATCHER":t.$store.dispatch("addWatcher",a.who).then((function(){}));break;case"CHAT":var r={text:a.message,from:a.from};if("COMMON"===a.to)return void t.$store.dispatch("updateCommonChat",r);t.$store.dispatch("chat",r);break;case"REMATCH":t.$store.dispatch("rematch",a.table).then((function(){}));break;case"POOL_UPDATE":t.$store.dispatch("poolUpdate",a);break;case"POOL_SELECT_POCKET":t.$store.dispatch("poolSelectPocket",a);break;case"POOL_HANDBALL":if("HANDBALL_FAIL"===a.pool.turnResult)t.$store.dispatch("poolSetHandBallFail",a);else{t.$store.dispatch("poolSetHandBall",a);var l={from:a.from,text:"Handball set by "+a.table.playerInTurn.name};t.$store.dispatch("chat",l)}break;case"POOL_PLAY_TURN":t.$store.dispatch("poolPlayTurn",a).then((function(){}));break;case"LEAVE_TABLE":t.$store.dispatch("leaveTable",a);break;case"GAME_END":var c={x:a.x,y:a.y,coordinates:a.x.toString().concat(a.y.toString()),token:a.token};if(3!==a.table.gameMode.gameNumber){if(t.$store.dispatch("move",c),"DRAW"===a.gameResult.resultType){var u={table:a.table,win:a.win};t.$store.dispatch("setDraw",u)}else{var h={winner:a.gameResult.winner.name,reason:vt.GAME,winsA:a.table.playerA.wins,winsB:a.table.playerB.wins,from:"System"};t.$store.dispatch("updateScore",h);var d={fromX:a.gameResult.fromX,fromY:a.gameResult.fromY,toX:a.gameResult.toX,toY:a.gameResult.toY,resultType:a.gameResult.resultType,winner:{name:a.gameResult.winner.name}};t.$store.dispatch("updateWinner",d)}return}3===a.table.gameMode.gameNumber&&(t.$store.dispatch("poolPlayTurn",a),t.$store.dispatch("poolGameEnded",a));break;case"RESIGN":var p={winner:a.who.name,reason:a.reason,winsA:a.table.playerA.wins,winsB:a.table.playerB.wins,from:a.from};t.$store.dispatch("resign",p);var m="R"===a.message?vt.RESIGNITION:vt.GAME,g=a.who.name.concat(m===vt.RESIGNITION?" won by resignation":" won"),b={from:a.from,text:g};t.$store.dispatch("chat",b);break}},n.onerror=function(e){},n.onclose=function(e){t.user&&(t.user.webSocket=null)}},createTable:function(){var e=null;if(e={title:"CREATE_TABLE",message:this.selectedGameMode,computer:this.playAgainstComputerChecked,randomStarter:this.randomStarterChecked,onlyRegistered:this.onlyRegistered},30===this.selectedGameMode){var t=this.selectedTimeControl;t||(t=0),e.timeControlIndex=t}this.user.webSocket.send(JSON.stringify(e)),this.computerLevel=null,this.playAgainstComputerChecked=!1,this.randomStarterChecked=!1,this.selectedTimeControl=null},getTableGameShortDesc:function(e){return e<20?"x.o":e<30?"4x":"Pool"},getBoardDesc:function(e){return e.gameMode.gameNumber<3?e.x+" x "+e.y:3===e.gameMode.gameNumber?"8-ball":"err"},onComputerSelectionChange:function(){this.playAgainstComputerChecked||(this.computerLevel="0")},onSelectedGameChange:function(e){3!==e.target.selectedIndex?this.selectedGameMode="0":this.selectedGameMode=30},removeTable:function(){var e={title:"REMOVE_TABLE",message:""};this.user.webSocket.send(JSON.stringify(e))},play:function(e){var t={title:"JOIN_TABLE",message:e.tableId};this.user.webSocket.send(JSON.stringify(t))},playButtonVisible:function(e){return(!e.playerA||!e.playerB)&&!(e.registeredOnly&&!this.authenticated)},isOwnTable:function(e){var t;return(null===e||void 0===e||null===(t=e.playerA)||void 0===t?void 0:t.name)===this.userName},watchTable:function(e){var t={title:"WATCH",message:e.tableId};this.user.webSocket.send(JSON.stringify(t))},openProfile:function(e){e.startsWith("Anonym")||this.$router.push({name:"Profile",params:{selectedName:e}})},getTimeControl:function(e){return this.getTimeControls()[e.timeControlIndex].seconds}}});const St=(0,Q.Z)(Bt,[["render",bt]]);var It=St,_t=(0,i.uE)('<div class="row" data-v-3b0cb7b0><div class="col fw-bold" data-v-3b0cb7b0> Hi! </div></div><div class="row mt-4" data-v-3b0cb7b0><div class="col question" data-v-3b0cb7b0> Play without registering <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 25 25" data-v-3b0cb7b0><path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z" data-v-3b0cb7b0></path></svg></div><div class="col" data-v-3b0cb7b0><p class="text-start" data-v-3b0cb7b0> 1. Click Games on the top navigation bar <br data-v-3b0cb7b0> 2. Join table <br data-v-3b0cb7b0> 3. Or create your own table with selected options <br data-v-3b0cb7b0> 4. Invite your friend to play or wait for random player </p></div></div><div class="row" data-v-3b0cb7b0><div class="col question" data-v-3b0cb7b0> Play with nickname <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 25 25" data-v-3b0cb7b0><path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z" data-v-3b0cb7b0></path></svg></div><div class="col" data-v-3b0cb7b0><p class="text-start" data-v-3b0cb7b0> 1. Click Registration <br data-v-3b0cb7b0> 2. Type nickname and password <br data-v-3b0cb7b0> 3. After registration, login and click play <br data-v-3b0cb7b0></p></div></div>',3);function Lt(e,t,n,a,i,o){return _t}var Dt=(0,i.aZ)({name:"Home",methods:{toMainPage:function(){this.$router.push("/")}},created:function(){}});const Rt=(0,Q.Z)(Dt,[["render",Lt],["__scopeId","data-v-3b0cb7b0"]]);var Mt=Rt,At=function(e){return(0,i.dD)("data-v-74b8d9bc"),e=e(),(0,i.Cn)(),e},Nt={class:"row"},Et={class:"col"},Ot=["disabled"],Gt={class:"row"},Ht={class:"col-xs-12 col-sm-4"},Vt=At((function(){return(0,i._)("br",null,null,-1)})),$t=At((function(){return(0,i._)("label",{class:"form-check-label ms-1",for:"highlight"},"Highlight last",-1)})),Ut=At((function(){return(0,i._)("br",null,null,-1)})),qt=At((function(){return(0,i._)("label",{class:"form-check-label ms-1",for:"soundOn"},"Notification sound",-1)})),zt=At((function(){return(0,i._)("br",null,null,-1)})),Wt=At((function(){return(0,i._)("br",null,null,-1)})),Ft=(0,i.Uk)(" vs. "),Yt=At((function(){return(0,i._)("br",null,null,-1)})),Qt={key:2,class:"text-success"},Zt={key:3,class:"text-success"},Jt={key:4,class:"text-danger"},Xt={class:"text-danger"},jt={class:"col-xs-12 col-sm-8"};function Kt(e,t,n,o,s,r){var l,c,h,d,p,m,g,b,f,v,y,T,w,k,x,C,P,B,S=(0,i.up)("chat");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",Nt,[(0,i._)("div",Et,[e.resignButtonVisible?((0,i.wg)(),(0,i.iD)("button",{key:0,disabled:e.resignButtonDisabled,onClick:t[0]||(t[0]=function(){return e.resign&&e.resign.apply(e,arguments)}),type:"button",class:"btn btn-primary w-30 float-xs-start float-sm-end"}," Resign ",8,Ot)):(0,i.kq)("",!0),e.rematchButtonEnabled?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t[1]||(t[1]=function(){return e.rematch&&e.rematch.apply(e,arguments)}),type:"button",class:"btn btn-primary w-30 float-xs-start float-sm-end"}," Rematch ")):(0,i.kq)("",!0)])]),(0,i._)("div",Gt,[(0,i._)("div",Ht,[(0,i.Uk)(" Connect "+(0,u.zw)(e.theTable.gameMode.requiredConnections)+" to win ",1),Vt,(0,i.wy)((0,i._)("input",{class:"form-check-input",type:"checkbox",id:"highlight",onChange:t[2]||(t[2]=function(){return e.highlightLastSquareIfSelected&&e.highlightLastSquareIfSelected.apply(e,arguments)}),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.showLastVal=t})},null,544),[[a.e8,e.showLastVal]]),$t,Ut,(0,i.wy)((0,i._)("input",{class:"form-check-input",type:"checkbox",id:"soundOn","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.soundOn=t})},null,512),[[a.e8,e.soundOn]]),qt,zt,e.theTable.playerA?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,u.C_)(["fw-bold",{"text-success":(null===(l=e.theTable.playerInTurn)||void 0===l?void 0:l.name)===(null===(c=e.theTable)||void 0===c||null===(h=c.playerA)||void 0===h?void 0:h.name)}])},(0,u.zw)(null===(d=e.theTable)||void 0===d||null===(p=d.playerA)||void 0===p?void 0:p.gameToken)+" = "+(0,u.zw)(null===(m=e.theTable)||void 0===m||null===(g=m.playerA)||void 0===g?void 0:g.name),3)):(0,i.kq)("",!0),Wt,Ft,Yt,e.theTable.playerB?((0,i.wg)(),(0,i.iD)("span",{key:1,class:(0,u.C_)(["fw-bold",{"text-success":(null===(b=e.theTable.playerInTurn)||void 0===b?void 0:b.name)===(null===(f=e.theTable)||void 0===f||null===(v=f.playerB)||void 0===v?void 0:v.name)}])},(0,u.zw)(null===(y=e.theTable)||void 0===y||null===(T=y.playerB)||void 0===T?void 0:T.gameToken)+" = "+(0,u.zw)(null===(w=e.theTable)||void 0===w||null===(k=w.playerB)||void 0===k?void 0:k.name),3)):(0,i.kq)("",!0),(null===(x=e.theTable.playerInTurn)||void 0===x?void 0:x.name)===e.userName?((0,i.wg)(),(0,i.iD)("span",Qt," It's your turn. ")):null===(null===(C=e.theTable)||void 0===C?void 0:C.playerInTurn)?((0,i.wg)(),(0,i.iD)("span",Zt," Game ended ")):((0,i.wg)(),(0,i.iD)("div",Jt," In turn: "+(0,u.zw)(null===(P=e.theTable.playerInTurn)||void 0===P?void 0:P.name),1)),(0,i._)("div",{class:(0,u.C_)({hidden:(null===(B=e.theTable.playerInTurn)||void 0===B?void 0:B.name)!==e.userName})},[(0,i._)("span",Xt," Time left "+(0,u.zw)(e.timeLeft),1)],2)]),(0,i._)("div",jt,[(0,i._)("canvas",{class:(0,u.C_)({"bg-secondary":null==e.theTable.playerInTurn}),id:"canvas"},null,2)])]),(0,i.Wm)(S,{id:e.theTable.id},null,8,["id"])],64)}n(4747),n(9826);var en={class:"row"},tn={class:"col overflow-auto",style:{"max-height":"500px !important"}};function nn(e,t,n,a,o,s){return(0,i.wg)(),(0,i.iD)("div",en,[(0,i._)("div",tn,[(0,i._)("ul",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.messagesd,(function(e,t){return(0,i.wg)(),(0,i.iD)("li",{key:t,class:(0,u.C_)(["list-group-item rounded-pill text-start w-75 text-break mb-1",[t%2==0?"bg-success p-2 text-dark bg-opacity-25":"bg-success p-2 text-dark bg-opacity-10"]])},"  "+(0,u.zw)(e.from)+":  "+(0,u.zw)(e.text),3)})),128))])])])}n(3210);var an=(0,i.aZ)({name:"Chat",mixins:[F],props:["id","common"],data:function(){return{messages:null,users:null,message:{text:""}}},computed:{messageExist:function(){return this.message.text.length>0},messagesd:function(){return this.common?this.$store.getters.commonChatMessages:this.$store.getters.chatMessages}},created:function(){},methods:{sendMessage:function(){var e=this.message.text.trim();if(e.length<1||e.length>75)this.message.text="";else{var t=this.common?"COMMON":this.id,n={title:"CHAT",message:e,to:t};this.user.webSocket.send(JSON.stringify(n)),this.message.text=""}}}});const on=(0,Q.Z)(an,[["render",nn]]);var sn=on,rn=(0,i.aZ)({components:{Chat:sn},name:"TableTicTacToe",mixins:[F],props:["watch"],data:function(){return{horizontalGap:null,verticalGap:null,canvas:null,renderingContext:null,showLastVal:!1,soundOn:!1,secondsLeft:120}},created:function(){var e,t=this;this.unsubscribe=this.$store.subscribe((function(e,n){if("move"===e.type){n.theTable.board;t.removeLastSquareHighLightning(),t.drawToken(t.theTable.board[t.theTable.board.length-1]),t.playMoveNotification(),t.highlightLastSquareIfSelected()}else if("changeTurn"===e.type)n.theTable.playerInTurn.name===t.userName?(t.addMouseListener(),t.startReducer()):(t.removeMouseListener(),t.stopReducer());else if("rematch"===e.type)t.initBoard();else if("updateWinner"===e.type){var a=n.theTable.win;t.removeMouseListener(),t.stopReducer(),t.drawWinningLine(a)}else"setDraw"!==e.type&&"resign"!==e.type||(t.stopReducer(),t.removeMouseListener())})),(null===(e=this.theTable.playerInTurn)||void 0===e?void 0:e.name)===this.userName&&(this.startTime=120,this.startReducer())},computed:{timeLeft:function(){return this.secondsLeft},theTable:function(){return this.$store.getters.theTable},iconColor:function(){var e=this.$store.getters.theTable.watchers;return e&&e.length>1?"green":"#000000"},watchers:function(){return this.$store.getters.theTable.watchers},resignButtonDisabled:function(){this.$store.getters.theTable;return!!this.watch||(!(!this.theTable||this.theTable.playerInTurn)||(this.theTable.playerInTurn.name!==this.userName||!!(this.theTable&&this.theTable.board&&this.theTable.board.length<4)))},rematchButtonEnabled:function(){var e=this.$store.getters.theTable;return!this.watch&&null===e.playerInTurn},resignButtonVisible:function(){var e,t,n,a;return this.userName===(null===(e=this.theTable)||void 0===e||null===(t=e.playerA)||void 0===t?void 0:t.name)||this.userName===(null===(n=this.theTable)||void 0===n||null===(a=n.playerB)||void 0===a?void 0:a.name)}},mounted:function(){this.$store.getters.theTable?(this.initBoard(),"1"===this.watch&&this.drawBoard()):this.$router.push("/error")},beforeUnmount:function(){this.unsubscribe(),this.stopReducer(),this.leaveTable()},methods:{startReducer:function(){var e=this;this.redurcerInterval&&this.stopReducer(),this.secondsLeft=120,this.redurcerInterval=setInterval((function(){e.secondsLeft=e.secondsLeft-1,e.secondsLeft<=0&&(e.stopReducer(),e.resign())}),1e3)},stopReducer:function(){clearInterval(this.redurcerInterval),this.secondsLeft=null},highlightLastSquareIfSelected:function(){if(this.showLastVal&&this.theTable.board.length>1){var e=this.theTable.board,t=e[e.length-1];this.drawToken(t,"#FF0000")}},playMoveNotification:function(){if(this.soundOn){var e=new window.AudioContext,t=e.createOscillator();t.type="sine",t.frequency.setValueAtTime(446,e.currentTime),t.connect(e.destination),t.start(),setTimeout((function(){t.stop()}),250)}},removeLastSquareHighLightning:function(){if(this.theTable.board.length>1){var e=this.theTable.board,t=e[e.length-2];this.drawToken(t,"#000000")}},removeMouseListener:function(){this.canvas.removeEventListener("click",this.handleClick,!1)},addMouseListener:function(){this.canvas.addEventListener("click",this.handleClick,!1)},drawWinningLine:function(e){this.renderingContext.beginPath(),this.renderingContext.moveTo(e.fromX*this.horizontalGap+this.horizontalGap/2-10,e.fromY*this.verticalGap+this.verticalGap/2),this.renderingContext.lineTo(e.toX*this.horizontalGap+this.horizontalGap/2+10,e.toY*this.verticalGap+this.verticalGap/2),this.renderingContext.strokeStyle="#00FFFF",this.renderingContext.lineWidth=5,this.renderingContext.stroke()},initBoard:function(){var e=this.theTable;this.canvas=document.getElementById("canvas"),this.renderingContext=this.canvas.getContext("2d");window.innerHeight,window.innerWidth;this.canvas.height=400,this.canvas.width=400,e.x>=10&&e.x<=20?(this.canvas.height=600,this.canvas.width=600):e.x>20&&(this.canvas.height=800,this.canvas.width=800);var t=e.x-1,n=e.y-1;this.verticalGap=this.canvas.height/e.x,this.horizontalGap=this.canvas.width/e.y;for(var a=0,i=0,o=0;o<t;o++)a+=this.horizontalGap,this.renderingContext.beginPath(),this.renderingContext.moveTo(a,i),this.renderingContext.lineTo(a,this.canvas.height),this.renderingContext.stroke();a=0,i=0;for(var s=0;s<n;s++)i+=this.verticalGap,this.renderingContext.beginPath(),this.renderingContext.moveTo(a,i),this.renderingContext.lineTo(this.canvas.width,i),this.renderingContext.stroke();this.theTable.playerInTurn.name===this.userName&&this.canvas.addEventListener("click",this.handleClick,!1)},drawBoard:function(){var e=this,t=this.theTable.board;t.forEach((function(t){e.drawToken(t)}))},drawToken:function(e,t){var n=e.token,a=e.x,i=e.y;if(n==ft.X){var o=Math.floor(a*this.horizontalGap+.1*this.horizontalGap),s=Math.floor(i*this.verticalGap+.1*this.verticalGap);t&&(this.renderingContext.strokeStyle=t),this.renderingContext.beginPath(),this.renderingContext.moveTo(o,s),this.renderingContext.lineTo(o+this.horizontalGap-.2*this.horizontalGap,s+this.verticalGap-.2*this.verticalGap),this.renderingContext.stroke(),this.renderingContext.beginPath(),this.renderingContext.moveTo(o,s+this.verticalGap-.2*this.verticalGap),this.renderingContext.lineTo(o+this.horizontalGap-.2*this.horizontalGap,s),this.renderingContext.stroke()}else{t&&(this.renderingContext.strokeStyle=t);var r=this.horizontalGap/2+a*this.horizontalGap,l=this.verticalGap/2+i*this.verticalGap,c=this.verticalGap/2*.85;this.renderingContext.beginPath(),this.renderingContext.arc(r,l,c,0,2*Math.PI),this.renderingContext.stroke()}},handleClick:function(e){var t=Math.floor(e.offsetX/this.verticalGap),n=Math.floor(e.offsetY/this.horizontalGap),a={x:t,y:n,coordinates:t.toString().concat(n.toString())},i=this.theTable.board.find((function(e){return e.coordinates===a.coordinates}));if(!i){this.removeMouseListener();var o={title:"MOVE",x:a.x,y:a.y};this.user.webSocket.send(JSON.stringify(o)),this.removeMouseListener()}},disableBoard:function(){return this.renderingContext.font="30px Arial",this.renderingContext.fillText("Game over",10,this.canvas.height/2),!0},rematch:function(){var e={title:"REMATCH",message:""};this.user.webSocket.send(JSON.stringify(e))},resign:function(){var e={title:"RESIGN",message:this.tablea};this.user.webSocket.send(JSON.stringify(e))},leaveTable:function(){var e,t,n={title:"LEAVE_TABLE",message:this.theTable.tableId};null===this||void 0===this||null===(e=this.user)||void 0===e||null===(t=e.webSocket)||void 0===t||t.send(JSON.stringify(n))}}});const ln=(0,Q.Z)(rn,[["render",Kt],["__scopeId","data-v-74b8d9bc"]]);var cn=ln,un={key:0,class:"row"},hn={class:"row col-md-6 offset-md-3 alert alert-info text-start"},dn=(0,i._)("br",null,null,-1),pn=(0,i._)("br",null,null,-1),mn={class:"row"},gn={key:1,class:"row"};function bn(e,t,n,a,o,s){var r=(0,i.up)("GameHistory");return(0,i.wg)(),(0,i.iD)(i.HY,null,[e.memberSince?((0,i.wg)(),(0,i.iD)("div",un,[(0,i._)("div",hn,[(0,i._)("b",null,(0,u.zw)(e.selectedName),1),dn,(0,i.Uk)(" Joined: "+(0,u.zw)(e.memberSince)+" ",1),pn,(0,i.Uk)(" "+(0,u.zw)(e.text),1)]),(0,i._)("div",mn,[e.eightBalls.length>0?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,u.C_)(["col-xs-12",this.getClass])},[(0,i.Wm)(r,{games:e.eightBalls,title:"Eight ball"},null,8,["games"])],2)):(0,i.kq)("",!0),e.connectFours.length>0?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,u.C_)(["col-xs-12",this.getClass])},[(0,i.Wm)(r,{games:e.connectFours,title:"Connect four"},null,8,["games"])],2)):(0,i.kq)("",!0),e.tictactoes.length>0?((0,i.wg)(),(0,i.iD)("div",{key:2,class:(0,u.C_)(["col-xs-12",this.getClass])},[(0,i.Wm)(r,{games:e.tictactoes,title:"TicTacToe"},null,8,["games"])],2)):(0,i.kq)("",!0)])])):(0,i.kq)("",!0),204==e.status||e.status>=400?((0,i.wg)(),(0,i.iD)("div",gn," User not found ")):(0,i.kq)("",!0)],64)}var fn={class:"fw-bold"},vn={class:"list-group"},yn={class:""},Tn=(0,i._)("br",null,null,-1),wn=(0,i._)("br",null,null,-1),kn=(0,i._)("br",null,null,-1),xn={key:0},Cn=(0,i._)("br",null,null,-1),Pn={key:1};function Bn(e,t,n,a,o,s){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("span",fn,(0,u.zw)(n.title),1),(0,i._)("ul",vn,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.games,(function(t,n){return(0,i.wg)(),(0,i.iD)("li",{key:t,class:(0,u.C_)(["list-group-item",[n%2==0?"bg-success p-2 text-dark bg-opacity-25":"bg-success p-2 text-dark bg-opacity-10"]])},[(0,i._)("div",yn,[(0,i.Uk)((0,u.zw)(e.convertInstantToDate(t.startInstant))+" ",1),Tn,(0,i.Uk)(" "+(0,u.zw)(t.playerAName)+" - "+(0,u.zw)(t.playerBName)+" ",1),wn,(0,i.Uk)(" "+(0,u.zw)(t.playerAStartRanking)+" ( "+(0,u.zw)(e.getRankingChange(t.playerAEndRanking,t.playerAStartRanking))+" ) vs. "+(0,u.zw)(t.playerBStartRanking)+" ( "+(0,u.zw)(e.getRankingChange(t.playerBEndRanking,t.playerBStartRanking))+" ) ",1),kn,(0,i.Uk)(" Board: "+(0,u.zw)(t.boardDescription)+" ",1),null!==t&&void 0!==t&&t.winnerUsername?((0,i.wg)(),(0,i.iD)("p",xn,[(0,i.Uk)(" Winner: "+(0,u.zw)(t.winnerUsername)+" ",1),Cn,(0,i.Uk)(" "+(0,u.zw)(e.convertResultToText(t.result)),1)])):((0,i.wg)(),(0,i.iD)("p",Pn,(0,u.zw)(e.convertResultToText(t.result)),1))])],2)})),128))])],64)}var Sn={props:{games:Array,title:String},mixins:[Tt],data:function(){return{}}};const In=(0,Q.Z)(Sn,[["render",Bn]]);var _n=In,Ln=(0,i.aZ)({name:"Profile",mixins:[F],components:{GameHistory:_n},props:{selectedName:String},data:function(){return{stats:null,text:null,memberSince:null,connectFours:[],tictactoes:[],status:-1,fetchText:"",eightBalls:[]}},computed:{getClass:function(){var e=this.eightBalls>0,t=this.tictactoes>0,n=this.connectFours>0;return e&&t&&n?"col-sm-4":"col-sm-6"}},created:function(){this.fetchProfile()},methods:{fetchProfile:function(){var e=this;this.status=-1,this.fetchText="";var t={method:"GET",headers:{"Content-Type":"application/json",Authorization:null}},n="http://35.217.7.146/portal/api/profile/"+this.selectedName;this.$store.dispatch("setLoadingStatus",!0),fetch(n,t).then((function(t){return e.status=t.status,200!==t.status?Promise.reject("error fetching profile"):t.json()})).then((function(t){e.text=t.user.profileText,e.memberSince=new Date(t.user.memberSince).toLocaleDateString(),e.tictactoes=t.user.tictactoes,e.connectFours=t.user.connectFours,e.eightBalls=t.user.eightBalls}),(function(e){console.error("error in profile fetch")})).finally((function(){e.$store.dispatch("setLoadingStatus",!1)}))}}});const Dn=(0,Q.Z)(Ln,[["render",bn]]);var Rn=Dn,Mn={class:"row mt-3"},An=(0,i._)("span",{class:"fw-bold"}," Hall of fame ",-1),Nn=(0,i._)("br",null,null,-1);function En(e,t,n,a,o,s){var r=(0,i.up)("Gamers");return(0,i.wg)(),(0,i.iD)("div",Mn,[(0,i._)("p",null,[An,Nn,(0,i.Uk)(" "+(0,u.zw)(e.dateTime),1)]),(0,i.Wm)(r,{games:e.eightBalls,totalGames:e.totalEightBalls,gameNumber:3,title:"Eight ball"},null,8,["games","totalGames"]),(0,i.Wm)(r,{games:e.connectFours,totalGames:e.totalConnectFours,gameNumber:2,title:"ConnectFour"},null,8,["games","totalGames"]),(0,i.Wm)(r,{games:e.tictactoes,totalGames:e.totalTictactoes,gameNumber:1,title:"TicTacToe"},null,8,["games","totalGames"])])}var On={class:"col-xs-12 col-sm-4 mt-3 mt-md-0 pt-3"},Gn={class:"fw-bold"},Hn={class:"list-group"},Vn={class:"float-end"};function $n(e,t,n,a,o,s){var r=this,l=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",On,[(0,i._)("span",Gn,(0,u.zw)(n.title),1),(0,i._)("ul",Hn,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.games,(function(e,t){return(0,i.wg)(),(0,i.iD)("li",{key:e,class:(0,u.C_)(["list-group-item",[t%2==0?"bg-success p-2 text-dark bg-opacity-25":"bg-success p-2 text-dark bg-opacity-10"]])},[(0,i.Wm)(l,{to:{name:"Profile",params:{selectedName:e.nickname}},class:"games-profile-link float-start"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,u.zw)(t+1)+"."+(0,u.zw)(e.nickname),1)]})),_:2},1032,["to"]),(0,i._)("span",Vn,(0,u.zw)(r.getRanking(e)),1)],2)})),128))]),(0,i.Uk)(" Games "+(0,u.zw)(n.totalGames),1)])}n(9653);var Un={name:"Gamers",props:{games:Array,title:String,totalGames:Number,gameNumber:Number},data:function(){return{}},computed:{},created:function(){},methods:{getRanking:function(e){return 3===this.gameNumber?e.rankingEightBall:2===this.gameNumber?e.rankingConnectFour:1===this.gameNumber?e.rankingTicTacToe:void 0}}};const qn=(0,Q.Z)(Un,[["render",$n]]);var zn=qn,Wn=(0,i.aZ)({name:"TopLists",components:{Gamers:zn},data:function(){return{connectFours:[],tictactoes:[],eightBalls:[],errorFlag:!1,dateTime:void 0,totalConnectFours:0,totalTictactoes:0,totalEightBalls:0}},computed:{},created:function(){this.fetchLists()},methods:{fetchLists:function(){var e=this;console.log("Ui starts fetch"),this.errorFlag=!1;var t={method:"GET",headers:{"Content-Type":"application/json",Authorization:null}},n="http://35.217.7.146/portal/api/toplists";this.$store.dispatch("setLoadingStatus",!0),fetch(n,t).then((function(e){return 200!==e.status?Promise.reject("error fetching lists"):e.json()})).then((function(t){e.connectFours=t.connectFours,e.tictactoes=t.tictactoes,e.eightBalls=t.eightBalls,e.dateTime=new Date(t.instant).toLocaleString(),e.totalConnectFours=t.totalConnectFours,e.totalTictactoes=t.totalTictactoes,e.totalEightBalls=t.totalEightBalls}),(function(t){e.errorFlag=!0})).finally((function(){e.$store.dispatch("setLoadingStatus",!1)}))}}});const Fn=(0,Q.Z)(Wn,[["render",En]]);var Yn=Fn,Qn=function(e){return(0,i.dD)("data-v-8056ca8c"),e=e(),(0,i.Cn)(),e},Zn={class:"row"},Jn={class:"col"},Xn=["disabled"],jn={class:"row"},Kn={class:"col-xs-12 col-sm-4"},ea=(0,i.Uk)(" Connect 4 table "),ta=Qn((function(){return(0,i._)("br",null,null,-1)})),na=Qn((function(){return(0,i._)("label",{class:"form-check-label ms-1",for:"highlight"},"Highlight last",-1)})),aa=Qn((function(){return(0,i._)("br",null,null,-1)})),ia=Qn((function(){return(0,i._)("label",{class:"form-check-label ms-1",for:"soundOn"},"Notification sound",-1)})),oa=Qn((function(){return(0,i._)("br",null,null,-1)})),sa=Qn((function(){return(0,i._)("br",null,null,-1)})),ra=(0,i.Uk)(" vs. "),la=Qn((function(){return(0,i._)("br",null,null,-1)})),ca={key:2,class:"text-success"},ua={key:3,class:"text-success"},ha={key:4,class:"text-danger"},da={class:"text-danger"},pa={class:"col-xs-12 col-sm-8"};function ma(e,t,n,o,s,r){var l,c,h,d,p,m,g,b,f,v,y,T,w,k,x,C,P,B,S=(0,i.up)("chat");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",Zn,[(0,i._)("div",Jn,[e.resignButtonVisible?((0,i.wg)(),(0,i.iD)("button",{key:0,disabled:e.resignButtonDisabled,onClick:t[0]||(t[0]=function(){return e.resign&&e.resign.apply(e,arguments)}),type:"button",class:"btn btn-primary w-30 float-xs-start float-sm-end"}," Resign ",8,Xn)):(0,i.kq)("",!0),e.rematchButtonEnabled?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t[1]||(t[1]=function(){return e.rematch&&e.rematch.apply(e,arguments)}),type:"button",class:"btn btn-primary w-30 float-xs-start float-sm-end"}," Rematch ")):(0,i.kq)("",!0)])]),(0,i._)("div",jn,[(0,i._)("div",Kn,[ea,ta,(0,i.wy)((0,i._)("input",{class:"form-check-input",type:"checkbox",id:"highlight",onChange:t[2]||(t[2]=function(){return e.highlightLastSquareIfSelected&&e.highlightLastSquareIfSelected.apply(e,arguments)}),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.showLastVal=t})},null,544),[[a.e8,e.showLastVal]]),na,aa,(0,i.wy)((0,i._)("input",{class:"form-check-input",type:"checkbox",id:"soundOn","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.soundOn=t})},null,512),[[a.e8,e.soundOn]]),ia,oa,e.theTable.playerA?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,u.C_)(["fw-bold",{"text-success":(null===(l=e.theTable.playerInTurn)||void 0===l?void 0:l.name)===(null===(c=e.theTable)||void 0===c||null===(h=c.playerA)||void 0===h?void 0:h.name)}])},(0,u.zw)(null===(d=e.theTable)||void 0===d||null===(p=d.playerA)||void 0===p?void 0:p.gameToken)+" = "+(0,u.zw)(null===(m=e.theTable)||void 0===m||null===(g=m.playerA)||void 0===g?void 0:g.name),3)):(0,i.kq)("",!0),sa,ra,la,e.theTable.playerB?((0,i.wg)(),(0,i.iD)("span",{key:1,class:(0,u.C_)(["fw-bold",{"text-success":(null===(b=e.theTable.playerInTurn)||void 0===b?void 0:b.name)===(null===(f=e.theTable)||void 0===f||null===(v=f.playerB)||void 0===v?void 0:v.name)}])},(0,u.zw)(null===(y=e.theTable)||void 0===y||null===(T=y.playerB)||void 0===T?void 0:T.gameToken)+" = "+(0,u.zw)(null===(w=e.theTable)||void 0===w||null===(k=w.playerB)||void 0===k?void 0:k.name),3)):(0,i.kq)("",!0),(null===(x=e.theTable.playerInTurn)||void 0===x?void 0:x.name)===e.userName?((0,i.wg)(),(0,i.iD)("span",ca," It's your turn. ")):null===(null===(C=e.theTable)||void 0===C?void 0:C.playerInTurn)?((0,i.wg)(),(0,i.iD)("span",ua," Game ended ")):((0,i.wg)(),(0,i.iD)("div",ha," In turn: "+(0,u.zw)(null===(P=e.theTable.playerInTurn)||void 0===P?void 0:P.name),1)),(0,i._)("div",{class:(0,u.C_)({hidden:(null===(B=e.theTable.playerInTurn)||void 0===B?void 0:B.name)!==e.userName})},[(0,i._)("span",da," Time left "+(0,u.zw)(e.timeLeft),1)],2)]),(0,i._)("div",pa,[(0,i._)("canvas",{class:(0,u.C_)({"bg-secondary":null==e.theTable.playerInTurn}),id:"canvas"},null,2)])]),(0,i.Wm)(S,{id:e.theTable.id},null,8,["id"])],64)}n(3290);var ga=(0,i.aZ)({components:{Chat:sn},name:"TableConnectFour",mixins:[F,wt],props:["watch"],data:function(){return{canvas:null,renderingContext:null,showLastVal:!1,soundOn:!1,secondsLeft:120,startingPosX:-1,startingPosY:-1,gameBoardHeight:-1,gameBoardWidth:-1,arcDiameter:-1,selectedColumn:-1}},created:function(){var e=this;this.unsubscribe=this.$store.subscribe((function(t,n){if("move"===t.type){n.theTable.board;e.removeLastSquareHighLightning(),e.drawToken(e.theTable.board[e.theTable.board.length-1]),e.playMoveNotification(),e.highlightLastSquareIfSelected()}else if("changeTurn"===t.type)n.theTable.playerInTurn.name===e.userName?(e.addMouseListeners(),e.startReducer()):(e.removeMouseListeners(),e.clearCircleIndicatorRow(),e.stopReducer());else if("rematch"===t.type)e.removeMouseListeners(),e.initBoard(),e.isMyTurnInStore()&&e.startReducer();else if("updateWinner"===t.type){var a=n.theTable.win;e.stopReducer(),e.removeMouseListeners(),e.drawWinningLine(a)}else"setDraw"!==t.type&&"resign"!==t.type||(e.stopReducer(),e.removeMouseListeners())}))},computed:{timeLeft:function(){return this.secondsLeft},theTable:function(){return this.$store.getters.theTable},watchers:function(){return this.$store.getters.theTable.watchers},resignButtonDisabled:function(){this.$store.getters.theTable;return!!this.watch||(!(!this.theTable||this.theTable.playerInTurn)||(this.theTable.playerInTurn.name!==this.userName||!!(this.theTable&&this.theTable.board&&this.theTable.board.length<4)))},rematchButtonEnabled:function(){var e=this.$store.getters.theTable;return!this.watch&&null===e.playerInTurn},resignButtonVisible:function(){var e,t,n,a;return this.userName===(null===(e=this.theTable)||void 0===e||null===(t=e.playerA)||void 0===t?void 0:t.name)||this.userName===(null===(n=this.theTable)||void 0===n||null===(a=n.playerB)||void 0===a?void 0:a.name)}},mounted:function(){this.$store.getters.theTable?(this.initBoard(),"1"===this.watch&&this.drawBoard()):this.$router.push("/error")},beforeUnmount:function(){this.unsubscribe(),this.stopReducer(),this.leaveTable()},methods:{startReducer:function(){var e=this;this.redurcerInterval&&this.stopReducer(),this.secondsLeft=120,this.redurcerInterval=setInterval((function(){e.secondsLeft--,e.secondsLeft<=0&&(e.stopReducer(),e.resign())}),1e3)},stopReducer:function(){clearInterval(this.redurcerInterval),this.secondsLeft=null},highlightLastSquareIfSelected:function(){if(this.showLastVal&&this.theTable.board.length>1){var e=this.theTable.board,t=e[e.length-1];this.drawToken(t,"#FF0000")}},playMoveNotification:function(){if(this.soundOn){var e=new window.AudioContext,t=e.createOscillator();t.type="sine",t.frequency.setValueAtTime(446,e.currentTime),t.connect(e.destination),t.start(),setTimeout((function(){t.stop()}),250)}},removeLastSquareHighLightning:function(){if(this.theTable.board.length>1){var e=this.theTable.board,t=e[e.length-2];this.drawToken(t,"#000000")}},removeMouseListeners:function(){this.canvas.removeEventListener("click",this.handleClick,!1),this.canvas.removeEventListener("mousemove",this.handleCircleIndicator)},addMouseListeners:function(){this.canvas.addEventListener("click",this.handleClick,!1),this.canvas.addEventListener("mousemove",this.handleCircleIndicator)},handleCircleIndicator:function(e){var t=Math.floor((e.offsetX-this.startingPosX)/this.arcDiameter)+1;if(t!=this.column&&t>0&&t<=this.theTable.x){var n,a,i,o=this.column*(this.arcDiameter/2);this.renderingContext.clearRect(o,0,o+this.arcDiameter,this.arcDiameter-3),this.column=t;var s=this.arcDiameter*this.column,r=this.arcDiameter/2;this.renderingContext.fillStyle="red",(null===(n=this.theTable)||void 0===n||null===(a=n.playerInTurn)||void 0===a?void 0:a.gameToken)===ft.X&&this.userName===(null===(i=this.theTable)||void 0===i?void 0:i.playerInTurn.name)&&(this.renderingContext.fillStyle="blue"),this.renderingContext.beginPath(),this.renderingContext.arc(s,r,23,0,2*Math.PI),this.renderingContext.fill()}},clearCircleIndicatorRow:function(){this.column=-1,this.renderingContext.clearRect(0,0,this.gameBoardWidth,this.arcDiameter-3)},drawWinningLine:function(e){this.renderingContext.beginPath();var t=(e.fromY+1)*this.arcDiameter,n=(e.fromX+1)*this.arcDiameter+this.arcDiameter/2,a=(e.toY+1)*this.arcDiameter,i=(e.toX+1)*this.arcDiameter+this.arcDiameter/2;this.renderingContext.moveTo(t,n),this.renderingContext.lineTo(a,i),this.renderingContext.strokeStyle="#00FFFF",this.renderingContext.lineWidth=5,this.renderingContext.stroke()},initBoard:function(){var e,t=this.theTable;this.canvas=document.getElementById("canvas"),this.renderingContext=this.canvas.getContext("2d"),this.canvas.height=440,this.canvas.width=440,t.x>=10&&t.x<=20?(this.canvas.height=620,this.canvas.width=620):t.x>20&&(this.canvas.height=800,this.canvas.width=800),this.arcDiameter=this.canvas.width/(t.x+1),this.drawBoardFrame(t),this.drawBoardLines(t),(null===(e=this.theTable.playerInTurn)||void 0===e?void 0:e.name)===this.userName&&this.addMouseListeners()},drawBoardFrame:function(e){this.gapBetweenArcs=28,this.gameBoardHeight=e.y*this.arcDiameter,this.gameBoardWidth=e.x*this.arcDiameter,this.startingPosX=this.gapBetweenArcs,this.startingPosY=this.arcDiameter,this.renderingContext.beginPath(),this.renderingContext.rect(this.startingPosX,this.startingPosY,this.gameBoardWidth,this.gameBoardHeight),this.renderingContext.stroke()},drawBoardLines:function(e){for(var t=0;t<e.x;t++)for(var n=0;n<e.y+1;n++)if(0!==n){var a=this.arcDiameter*t+this.arcDiameter,i=this.arcDiameter*n+this.gapBetweenArcs;this.renderingContext.beginPath(),this.renderingContext.arc(a,i,25,0,2*Math.PI),this.renderingContext.stroke()}},drawBoard:function(){var e=this,t=this.theTable.board;t.forEach((function(t){e.drawToken(t)}))},drawToken:function(e,t){var n=e.token;n==ft.O?this.renderingContext.fillStyle="red":this.renderingContext.fillStyle="blue";var a=this.arcDiameter*(e.x+1)+this.gapBetweenArcs,i=this.arcDiameter*e.y+this.arcDiameter;this.renderingContext.beginPath(),this.renderingContext.arc(i,a,23,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.fill()},handleClick:function(e){var t={title:"MOVE",y:this.column-1};this.user.webSocket.send(JSON.stringify(t))},disableBoard:function(){return this.renderingContext.font="30px Arial",this.renderingContext.fillText("Game over",10,this.canvas.height/2),!0},rematch:function(){var e={title:"REMATCH",message:""};this.user.webSocket.send(JSON.stringify(e))},resign:function(){var e={title:"RESIGN",message:this.tablea};this.user.webSocket.send(JSON.stringify(e))},leaveTable:function(){var e,t,n={title:"LEAVE_TABLE",message:this.theTable.tableId};null===this||void 0===this||null===(e=this.user)||void 0===e||null===(t=e.webSocket)||void 0===t||t.send(JSON.stringify(n))}}});const ba=(0,Q.Z)(ga,[["render",ma],["__scopeId","data-v-8056ca8c"]]);var fa=ba,va=function(e){return(0,i.dD)("data-v-a912993e"),e=e(),(0,i.Cn)(),e},ya={class:"row"},Ta={class:"col"},wa=["disabled"],ka={class:"row"},xa={class:"col-xs-12 col-sm-4"},Ca=va((function(){return(0,i._)("label",{class:"selectora",for:"notificationSound","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Beeps last 14 seconds in turn if checked"},[(0,i._)("i",{class:"bi bi-music-note"})],-1)})),Pa={class:"ps-4"},Ba=va((function(){return(0,i._)("label",{class:"",for:"pointerLine"},"Bridge",-1)})),Sa={class:"row"},Ia={class:"col-xs-12 col-sm-4"},_a={key:0,class:"text-success"},La={key:1,class:"text-success"},Da={key:2,class:"text-success"},Ra={key:3,class:"text-danger"},Ma={class:"col-xs-12 col-sm-8"};function Aa(e,t){var n,o,s,r=(0,i.up)("chat");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",ya,[(0,i._)("div",Ta,[e.resignButtonVisible?((0,i.wg)(),(0,i.iD)("button",{key:0,disabled:e.resignButtonDisabled,onClick:t[0]||(t[0]=function(){return e.resign&&e.resign.apply(e,arguments)}),type:"button",class:"btn btn-primary w-30 float-xs-start float-sm-end"}," Resign ",8,wa)):(0,i.kq)("",!0),e.rematchButtonEnabled?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t[1]||(t[1]=function(){return e.rematch&&e.rematch.apply(e,arguments)}),type:"button",class:"btn btn-primary w-30 float-xs-start float-sm-end"}," Rematch ")):(0,i.kq)("",!0)])]),(0,i._)("div",ka,[(0,i._)("div",xa,[Ca,(0,i.wy)((0,i._)("input",{type:"checkbox",id:"notificationSound","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.gameOptions.soundOn=t})},null,512),[[a.e8,e.gameOptions.soundOn]]),(0,i._)("span",Pa,[(0,i.wy)((0,i._)("input",{class:"",type:"checkbox",id:"pointerLine","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.gameOptions.pointerLine=t})},null,512),[[a.e8,e.gameOptions.pointerLine]]),Ba])])]),(0,i._)("div",Sa,[(0,i._)("div",Ia,[e.playingTurn?((0,i.wg)(),(0,i.iD)("span",_a,"Playing turn")):(null===(n=e.theTable.playerInTurn)||void 0===n?void 0:n.name)===e.userName?((0,i.wg)(),(0,i.iD)("span",La," It's your turn "+(0,u.zw)(e.userName)+" > time left:"+(0,u.zw)(this.theTable.secondsLeft),1)):null===(null===(o=e.theTable)||void 0===o?void 0:o.playerInTurn)?((0,i.wg)(),(0,i.iD)("span",Da," Game ended ")):((0,i.wg)(),(0,i.iD)("div",Ra," In turn: "+(0,u.zw)(null===(s=e.theTable.playerInTurn)||void 0===s?void 0:s.name),1))])]),(0,i._)("div",Ma,[(0,i._)("canvas",{id:"canvas",width:"400",height:"400",style:{border:"1px solid"},class:(0,u.C_)({"bg-secondary":null==e.theTable.playerInTurn})},null,2)]),(0,i.Wm)(r,{id:e.theTable.id},null,8,["id"])],64)}var Na=n(4648),Ea=(n(561),n(4553),n(9503)),Oa=1200,Ga=677,Ha=900,Va=12,$a=34,Ua=.991,qa=1/8,za=void 0,Wa=void 0,Fa=void 0,Ya=(0,i.aZ)({components:{Chat:sn},name:"PoolTable",mixins:[F,wt,Pt],props:["watch"],data:function(){return{canvas:void 0,balls:[],cueBall:void 0,cue:void 0,poolTable:void 0,gameOptions:{pointerLine:!1,notificationSound:!0},mouseCoordsTemp:void 0,handBall:!1,playingTurn:!1,resultSnapshot:void 0,pocketSelection:!1,selectedPocket:null,turnQueue:{turns:[],blocked:!1}}},watch:{turnQueueLength:{handler:function(e,t){e>t&&this.consumeTurns()}},mouseEnabled:{handler:function(e,t){e&&!Fa?(console.log("watcher:restartReducerInterval"),this.restartReducerInterval()):e||(this.stopReducerInterval(),this.stopCueInterval(),Fa=null)}},timeRunOut:{handler:function(e,t){e&&(console.log("watcher:stopreducer"),this.stopReducerInterval(),(this.isOngoingGame()&&this.isMyTurnInSnapshot()||!1===this.firstTurnPlayed||void 0===this.firstTurnPlayed)&&this.resign())}}},created:function(){var e=this;this.unsubscribe=this.$store.subscribe((function(t,n){"rematch"===t.type&&(e.resultSnapshot=null,e.initTable()),"resign"===t.type&&(e.theTable.playerInTurn=null,e.handleGameEnd(),e.clearTurnQueue(),e.draw())}))},mounted:function(){var e=this;if(this.initTable(),"1"===this.watch){this.clearTurnQueue(),this.updatePocketedBalls(this.theTable.playerABalls),this.updatePocketedBalls(this.theTable.playerBBalls,!1),this.updateRemainingBallPositions(this.theTable.remainingBalls,this.balls);var t=this.theTable.remainingBalls[this.theTable.remainingBalls.length-1];this.cue.position=t.position,this.unblockQueue(),this.draw()}this.unsubscribeAction=this.$store.subscribeAction((function(t,n){if("poolUpdate"===t.type)return e.cue.image.canvasRotationAngle=t.payload.pool.cue.angle,e.cue.angle=t.payload.pool.cue.angle,void e.draw();"poolPlayTurn"!==t.type&&"poolSetHandBall"!==t.type&&"poolSelectPocket"!==t.type&&"poolSetHandBallFail"!==t.type&&"poolGameEnded"!==t.type||(e.resetInstanceVariables(),e.createTableSnapshot(t),!e.isDocumentVisible()&&e.isTimerRestartRequiredForAction(t)&&e.isMe(t.payload.table.playerInTurn.name)&&e.restartReducerInterval(),e.isDocumentVisible&&(e.produceTurns(t),e.draw()))})),new Ea.u(document.getElementsByClassName("selectora")[0])},computed:{turnQueueLength:function(){return this.turnQueue.turns.length},mouseEnabled:function(){var e=this.$store.getters.playerInTurn;if(!e)return this.draw(),!1;if(!this.poolTable)return!1;var t=this.$store.getters.playerInTurn.name===this.userName&&this.poolTable.mouseEnabled;return console.log("computed mouseEnabled:"+t),t},cueVisible:function(){return this.mouseEnabled},timeRunOut:function(){return this.theTable.secondsLeft<=0}},beforeUnmount:function(){this.unsubscribe(),this.unsubscribeAction(),this.clearIntervals(),this.removeMouseListeners(),document.removeEventListener("visibilitychange",this.onVisibilityChange),this.leaveTable()},methods:{resetInstanceVariables:function(){this.handBall=!1,this.selectedPocket=null,this.pocketSelection=!1,this.cue.force=0,this.cue.position=this.cueBall.position,this.resultSnapshot=null},clearIntervals:function(){this.stopCueInterval(),clearInterval(Wa),clearInterval(Fa)},isTimerRestartRequiredForAction:function(e){var t="poolPlayTurn"==e.type||"poolSetHandBall"===e.type||"poolSelectPocket"===e.type;return t},consumeTurns:function(){var e=this;if(0===this.turnQueue.turns.length){var t=!!this.isMyTurnInStore();return this.poolTable.mouseEnabled=t,void console.log("TurnQueue is empty, mouseEnabled "+this.poolTable.mouseEnabled)}if(this.turnQueue.blocked)console.log("TurnQueue is blocked, not consuming");else{this.turnQueue.blocked=!0;var n=this.turnQueue.turns.splice(0,1)[0];if(console.log("Starting to consume turn "+JSON.stringify(n)),n.shootBall)console.log("shootball"),this.firstTurnPlayed=!0,this.shootBall(n).then((function(){console.log("shootball done"),e.selectedPocket=null,e.cue.force=0;var t=e.isMyTurnInStore()?0:1500;e.unblockQueue(t),e.playingTurn=!1}));else if(n.setHandBall){this.setHandBall(n);var a=this.isMyTurnInStore()?0:2e3;this.unblockQueue(a)}else null!=n.setSelectedPocket?(this.selectedPocket=n.setSelectedPocket,this.pocketSelection=!1,this.unblockQueue(250)):n.askHandBallPosition?(this.handBall=!0,this.cueBall.image.visible=!0,this.unblockQueue(0)):n.lastTurn?this.handleGameEnd(n):n.askPocketSelection?(this.pocketSelection=!0,this.unblockQueue(0)):n.changePlayer&&this.$store.dispatch("changeTurn",n.nextTurnPlayer).then((function(){e.unblockQueue(0)}))}},unblockQueue:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.turnQueue.blocked=!1,this.draw(),setTimeout((function(){e.consumeTurns()}),t)},produceTurns:function(e){"poolPlayTurn"===e.type?(this.createShootBallTurn(e),"CHANGE_TURN"===e.payload.pool.turnResult?this.createChangePlayerTurn(e):"HANDBALL"===e.payload.pool.turnResult?(this.createChangePlayerTurn(e),this.isMe(e.payload.pool.whoPlayed)||this.createAskHandBallPositionTurn(e)):"ASK_POCKET_SELECTION"===e.payload.pool.turnResult&&(this.isTurnChange(e.payload.table.playerInTurn)&&this.createChangePlayerTurn(e),this.isMe(e.payload.table.playerInTurn.name)&&this.createAskPocketSelectionTurn(e))):"poolSetHandBallFail"===e.type?this.createAskHandBallPositionTurn(e):"poolSetHandBall"===e.type?(this.createPoolSetHandBallTurn(e),"ASK_POCKET_SELECTION"===e.payload.pool.turnResult&&(this.isTurnChange(e.payload.table.playerInTurn)&&this.createChangePlayerTurn(e),this.isMe(e.payload.table.playerInTurn.name)&&this.createAskPocketSelectionTurn(e))):"poolSelectPocket"===e.type?this.createSelectPocketTurn(e):"poolGameEnded"===e.type&&this.createLastTurn(e)},createAskHandBallPositionTurn:function(e){var t={turnResult:e.payload.pool.turnResult,askHandBallPosition:!0,askPocketSelection:!1,setSelectedPocket:null,setHandBall:!1,lastTurn:!1,whoPlayed:e.payload.pool.whoPlayed};return this.turnQueue.turns.splice(this.turnQueue.turns.length,0,t),console.log("produced: createAskHandBallPositionTurn"+this.turnQueue.turns.length),t},createAskPocketSelectionTurn:function(e){e.payload.pool.selectedPocket;var t=e.payload.table.playerInTurn,n={changePlayer:!1,turnResult:e.payload.pool.turnResult,askPocketSelection:!0,setSelectedPocket:null,setHandBall:null,nextTurnPlayer:t,lastTurn:!1,whoPlayed:e.payload.pool.whoPlayed};return this.turnQueue.turns.splice(this.turnQueue.turns.length,0,n),console.log("produced: createAskPocketSelectionTurn"+this.turnQueue.turns.length),n},createSelectPocketTurn:function(e){var t=e.payload.pool.selectedPocket,n={turnResult:e.payload.pool.turnResult,askPocketSelection:!1,setSelectedPocket:t,setHandBall:null,lastTurn:!1,whoPlayed:e.payload.pool.whoPlayed};return this.turnQueue.turns.splice(this.turnQueue.turns.length,0,n),console.log("produced: createSelectPocketTurn"+this.turnQueue.turns.length),n},createLastTurn:function(e){var t=e.payload.pool.turnResult,n=e.payload.pool.winner.name,a={askPocketSelection:!1,setSelectedPocket:null,setHandBall:null,lastTurn:!0,winner:n,winReason:t,whoPlayed:e.payload.pool.whoPlayed};return this.turnQueue.turns.splice(this.turnQueue.turns.length,0,a),console.log("produced: createLastTurn"+this.turnQueue.turns.length),a},createChangePlayerTurn:function(e){var t=e.payload.table.playerInTurn,n={changePlayer:!0,nextTurnPlayer:t,lastTurn:!1,whoPlayed:e.payload.pool.whoPlayed};return this.turnQueue.turns.splice(this.turnQueue.turns.length,0,n),console.log("produced: createChangePlayerTurn"+this.turnQueue.turns.length),n},createShootBallTurn:function(e){var t=e.payload.pool.cue;t.force=e.payload.pool.cue.force,t.angle=e.payload.pool.cue.angle;var n={shootBall:!0,cue:t,turnResult:e.payload.pool.turnResult,lastTurn:!1,whoPlayed:e.payload.pool.whoPlayed};return this.turnQueue.turns.splice(this.turnQueue.turns.length,0,n),console.log("produced: createShootBallTurn"+this.turnQueue.turns.length),n},createPoolSetHandBallTurn:function(e){var t=Object.assign({},this.cueBall);t.position=e.payload.pool.cueBall.position,t.inPocket=!1,t.image.visible=!0;var n=(0,Na.Z)({},this.cue);n.force=0,n.position=t.position;var a={cue:n,cueBall:t,turnResult:e.payload.pool.turnResult,setHandBall:!0,nextTurnPlayer:e.payload.table.playerInTurn,lastTurn:!1,whoPlayed:e.payload.pool.whoPlayed};return this.turnQueue.turns.splice(this.turnQueue.turns.length,0,a),console.log("produced: createPoolSetHandBallTurn"+this.turnQueue.turns.length),a},handleGameEnd:function(e){if(this.theTable.playerInTurn=null,this.clearTurnQueue(),this.turnQueue.blocked=!0,this.clearIntervals(),this.removeMouseListeners(),this.poolTable.mouseEnabled=!1,e){var t={from:"System",text:e.winner+" won ( "+e.winReason.toLowerCase()+" )"};this.$store.dispatch("chat",t)}this.draw()},setHandBall:function(e){this.cueBall.position=e.cueBall.position,this.cueBall.inPocket=!1,this.cue.position=this.cueBall.position,this.handBall=!1,this.cue.force=0,this.cueBall.image.visible=!0},createTableSnapshot:function(e){this.firstTurnPlayed=!0,this.resultSnapshot=e},updateRemainingBallPositions:function(e,t){var n=this;e.forEach((function(e){var a=t.find((function(t){return t.number===e.number}));n.updateBallPropertiesWithoutFriction(a,e.position)}))},updateBallPropertiesWithoutFriction:function(e,t){e.position.x=t.x,e.position.y=t.y,e.velocity.x=0,e.velocity.y=0},updatePocketedBalls:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&0!==e.length)for(var a=n?.12*this.canvas.width:.55*this.canvas.width,i=function(n){var i=e[n],o=t.balls.find((function(e){return e.number===i.number}));if(!o)return"continue";o.position.x=a+n*o.diameter,o.position.y=.06*t.canvas.height,o.inPocket||(o.image.canvasDimension.x=.8*o.image.canvasDimension.x,o.image.canvasDimension.y=.8*o.image.canvasDimension.y),o.inPocket=!0},o=0;o<e.length;o++)i(o)},movePocketedBallToEdgeOfTable:function(e){if(8!==e.number&&0!==e.number){var t=this.resultSnapshot.payload.table.playerABalls.findIndex((function(t){return t.number===e.number})),n=.12*this.canvas.width;-1===t&&(t=this.resultSnapshot.payload.table.playerBBalls.findIndex((function(t){return t.number===e.number}))+1,n=.55*this.canvas.width),e.position.x=n+t*e.diameter,e.position.y=.06*this.canvas.height}},putBallInMiddleOfPocket:function(e,t){e.inPocket||(e.velocity.x=0,e.velocity.y=0,t&&(e.position.x=t.center.x,e.position.y=t.center.y),e.inPocket=!0,0!==e.number&&8!==e.number&&(e.image.canvasDimension.x=.8*e.image.canvasDimension.x,e.image.canvasDimension.y=.8*e.image.canvasDimension.y))},draw:function(){this.isDocumentVisible()&&requestAnimationFrame(this.repaintAll)},repaintComponent:function(e){var t=e.image;e.image.visible&&(this.renderingContext.translate(e.position.x,e.position.y),t.canvasRotationAngle&&this.renderingContext.rotate(t.canvasRotationAngle),t.canvasDestination||(t.canvasDestination={x:0,y:0}),this.gameOptions&&this.gameOptions.pointerLine&&e.hasOwnProperty("force")&&(this.renderingContext.beginPath(),this.renderingContext.moveTo(-200,0),this.renderingContext.lineTo(200,0),this.renderingContext.stroke(),this.renderingContext.beginPath(),this.renderingContext.moveTo(0,-200),this.renderingContext.lineTo(0,200),this.renderingContext.stroke()),!this.isMyTurnInStore()&&e.hasOwnProperty("force")?this.renderingContext.drawImage(t.image,1430,0,100,22,t.canvasDestination.x+825,t.canvasDestination.y,88,10):this.renderingContext.drawImage(t.image,0,0,t.realDimension.x,t.realDimension.y,t.canvasDestination.x,t.canvasDestination.y,t.canvasDimension.x,t.canvasDimension.y),this.renderingContext.resetTransform())},repaintAll:function(){this.renderingContext.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.repaintComponent(this.poolTable),this.repaintComponent(this.cueBall);for(var e=0;e<this.balls.length;e++)this.repaintComponent(this.balls[e]);if(this.isOngoingGame()||this.repaintGameEnd(),this.repaintNames(),this.handBall||this.playingTurn||this.repaintComponent(this.cue),this.handBall&&this.isMyTurnInStore()&&(this.renderingContext.font="bolder 16px Arial",this.renderingContext.fillText("Set handball position",400,35)),this.pocketSelection&&this.isMyTurnInStore()){var t=null===this.selectedPocket?0:this.selectedPocket;this.repaintPocketSelection(t),this.renderingContext.font="bolder 16px Arial",this.renderingContext.fillText("Click to select pocket",400,35)}else null!==this.selectedPocket&&this.repaintPocketSelection(this.selectedPocket);this.renderingContext.fillStyle="black"},repaintGameEnd:function(){this.renderingContext.globalAlpha=.4,this.renderingContext.fillStyle="gray",this.renderingContext.fillRect(0,0,this.canvas.width,this.canvas.height)},initTable:function(){this.balls=[],this.turnQueue={turns:[],blocked:!1};var e=window.innerWidth,t=window.innerHeight;this.canvas=document.getElementById("canvas"),this.renderingContext=this.canvas.getContext("2d",{alpha:!1});var n=e,a=t;n=Oa,a=Ga,this.canvas.height=a,this.canvas.width=n,document.addEventListener("visibilitychange",this.onVisibilityChange);var i={x:Oa,y:Ga},o={image:document.getElementById("tableImg"),canvasDimension:i,realDimension:{x:4551,y:2570},canvasRotationAngle:{x:0,y:0},visible:!0};this.poolTable={image:o,position:{x:0,y:0},mouseEnabled:!1};var s={a:79,b:118,c:572},r={a:79,b:644,c:1090},l={a:1122,b:118,c:560},c={a:600,b:644,c:1090},u={a:600,b:118,c:572},h={a:80,b:118,c:560};this.poolTable.pockets=[],this.poolTable.topLeftPart=s,this.poolTable.topRightPart=r,this.poolTable.rightPart=l,this.poolTable.bottomRightPart=c,this.poolTable.bottomLeftPart=u,this.poolTable.leftPart=h;var d={center:{x:65,y:61},radius:32,pathwayLeft:{top:{x:54,y:93},bottom:{x:80,y:118}},pathwayRight:{top:{x:96,y:56},bottom:{x:117,y:77}}},p={center:{x:607,y:49},radius:28,pathwayLeft:{top:{x:580,y:56},bottom:{x:571,y:79}},pathwayRight:{top:{x:635,y:56},bottom:{x:644,y:79}}},m={center:{x:1144,y:61},radius:32,pathwayLeft:{top:{x:1112,y:56},bottom:{x:1089,y:79}},pathwayRight:{top:{x:1144,y:93},bottom:{x:1122,y:118}}},g={center:{x:1144,y:614},radius:32,pathwayLeft:{top:{x:1091,y:600},bottom:{x:1112,y:620}},pathwayRight:{top:{x:1122,y:562},bottom:{x:1142,y:580}}},b={center:{x:607,y:628},radius:28,pathwayLeft:{top:{x:571,y:600},bottom:{x:580,y:620}},pathwayRight:{top:{x:644,y:600},bottom:{x:635,y:620}}},f={center:{x:65,y:614},radius:32,pathwayLeft:{top:{x:80,y:558},bottom:{x:54,y:584}},pathwayRight:{top:{x:118,y:600},bottom:{x:98,y:620}}};this.poolTable.pockets.push(d),this.poolTable.pockets.push(p),this.poolTable.pockets.push(m),this.poolTable.pockets.push(g),this.poolTable.pockets.push(b),this.poolTable.pockets.push(f),this.poolTable.topMiddlePocket=p,this.poolTable.topRightPocket=m,this.poolTable.bottomRightPocket=g,this.poolTable.bottomMiddlePocket=b,this.poolTable.bottomLeftPocket=f;var v={x:$a,y:$a},y={image:document.getElementById("0"),canvasDimension:v,realDimension:{x:141,y:141},canvasRotationAngle:{x:0,y:0},canvasDestination:{x:-$a/2,y:-$a/2},visible:!0};this.cueBall={image:y,diameter:$a,radius:$a/2,position:{x:1030,y:150},number:0,color:"white",velocity:{x:0,y:0}};var T={x:Ha,y:Va},w={image:document.getElementById("cue3Img"),canvasDimension:T,realDimension:{x:1508,y:22},canvasDestination:{x:-T.x-$a,y:-T.y/2},canvasRotationAngle:{x:0,y:0},visible:!0};this.isPlayerInTurn(this.userName)&&(this.handBall=!0,this.poolTable.mouseEnabled=!0);var k={x:this.cueBall.position.x,y:this.cueBall.position.y},x=0;this.cue={position:k,image:w,force:x,angle:0};for(var C=1;C<16;C++){var P=this.createBall(C,this.cueBall.diameter);this.balls.push(P)}this.balls.push(this.cueBall),"1"!==this.watch&&(this.removeMouseListeners(),this.addMouseListeners()),this.draw()},isDocumentVisible:function(){return"visible"===document.visibilityState},onVisibilityChange:function(){this.isDocumentVisible()?(this.stopCueInterval(),clearInterval(Wa),this.createTableFromSnapShot(),this.clearTurnQueue(),this.unblockQueue(0),this.draw()):(this.turnQueue.blocked=!0,this.stopCueInterval(),clearInterval(Wa))},clearTurnQueue:function(){this.turnQueue.turns.splice(0,this.turnQueue.turns.length)},createTableFromSnapShot:function(){if(this.resultSnapshot){var e=this.resultSnapshot.payload.table,t=this.resultSnapshot.payload.pool;this.playingTurn=!1,this.updatePocketedBalls(e.playerABalls),this.updatePocketedBalls(e.playerBBalls,!1),this.updateRemainingBallPositions(e.remainingBalls,this.balls),this.cueBall.position=t.cueBall.position,this.cueBall.velocity.x=0,this.cueBall.velocity.y=0;var n=e.playerInTurn;if(this.changeTurnIfRequired(n),t.winner){console.log("winner from snapshot"+t.winner.name);var a=t.winner.name,i=t.turnResult,o={askPocketSelection:!1,setSelectedPocket:null,setHandBall:null,lastTurn:!0,winner:a,winReason:i,whoPlayed:t.whoPlayed};this.handleGameEnd(o)}else this.isMyTurnInStore()&&(this.poolTable.mouseEnabled=!0);"HANDBALL"===t.turnResult&&this.isMyTurnInStore()?this.handBall=!0:"ASK_POCKET_SELECTION"===t.turnResult&&this.isMyTurnInStore()&&(this.pocketSelection=!0),requestAnimationFrame(this.repaintAll)}},isTableTopBoundry:function(e){return e.position.x>=this.poolTable.topLeftPart.b&&e.position.x<=this.poolTable.topLeftPart.c&&e.position.y-this.cueBall.radius<=this.poolTable.topLeftPart.a||e.position.x>=this.poolTable.topRightPart.b&&e.position.x<=this.poolTable.topRightPart.c&&e.position.y-this.cueBall.radius<=this.poolTable.topRightPart.a},isTableLeftBoundry:function(e){return e.position.x<=this.poolTable.leftPart.a+this.cueBall.radius&&e.position.y>=this.poolTable.leftPart.b&&e.position.y<=this.poolTable.leftPart.c},isTableRightBoundry:function(e){return e.position.x>=this.poolTable.rightPart.a-this.cueBall.radius&&e.position.y>=this.poolTable.rightPart.b&&e.position.y<=this.poolTable.rightPart.c},isTableBottomBoundry:function(e){return e.position.x>=this.poolTable.bottomLeftPart.b&&e.position.x<=this.poolTable.bottomLeftPart.c&&e.position.y+this.cueBall.radius>=this.poolTable.bottomLeftPart.a||e.position.x>=this.poolTable.bottomRightPart.b&&e.position.x<=this.poolTable.bottomRightPart.c&&e.position.y+this.cueBall.radius>=this.poolTable.bottomRightPart.a},restartReducerInterval:function(e){var t=this;Fa&&this.stopReducerInterval(),this.theTable.secondsLeft=this.getTimeControls()[this.theTable.timeControlIndex].seconds,Fa=setInterval((function(){t.theTable.secondsLeft--,t.gameOptions.soundOn&&t.theTable.secondsLeft<15&&t.playNotificationSound()}),1e3)},startCueInterval:function(){console.log("called startCueInterval"),za&&(console.log("called startCueInterval stopping first"),this.stopInterval()),za=setInterval(this.updateCueForce,50),console.log("called startCueInterval startin really"+za)},stopCueInterval:function(){console.log("stopping cueForceInterval "+za),za=clearInterval(za),console.log("stopped cueForceInterval"+za)},stopReducerInterval:function(){Fa=clearInterval(Fa),console.log("stoppedReducerInterval"+Fa)},createBall:function(e,t){var n={x:t,y:t},a={x:.65*this.canvas.width+.9*t*this.calculateRackColumn(e),y:this.canvas.height/2+.5*t*this.calculateRackRow(e)},i={image:document.getElementById(e.toString()),canvasDimension:n,realDimension:{x:141,y:141},canvasRotationAngle:{x:0,y:0},canvasDestination:{x:-t/2,y:-t/2},visible:!0};return{image:i,diameter:t,radius:t/2,position:a,number:e,color:this.calculateBallColor(e),velocity:{x:0,y:0}}},addMouseListeners:function(){this.canvas.addEventListener("mousemove",this.handleMouseMove),this.canvas.addEventListener("mousedown",this.handleMouseDown),this.canvas.addEventListener("mouseup",this.handleMouseUp),this.canvas.onpointerdown=this.handleMouseDown,this.canvas.onpointerup=this.handleMouseUp,this.canvas.onpointermove=this.handleMouseMove,this.canvas.addEventListener("pointerdown",this.handleMouseDown,!1),this.canvas.addEventListener("pointerup",this.handleMouseUp,!1),this.canvas.addEventListener("pointermove",this.handleMouseMove,!1),this.canvas.addEventListener("contextmenu",(function(e){return e.preventDefault()}))},removeMouseListeners:function(){this.canvas.removeEventListener("mousemove",this.handleMouseMove),this.canvas.removeEventListener("mousedown",this.handleMouseDown),this.canvas.removeEventListener("mouseup",this.handleMouseUp),this.canvas.removeEventListener("contextmenu",(function(e){return e.preventDefault()})),this.canvas.removeEventListener("pointerdown",this.handleMouseUp),this.canvas.removeEventListener("pointerup",this.handleMouseUp),this.canvas.removeEventListener("pointermove",this.handleMouseUp)},handleMouseDown:function(e){2!==e.button&&this.poolTable.mouseEnabled&&(this.pocketSelection||this.poolTable.mouseEnabled&&!this.handBall&&(this.cue.force=0,console.log("cueForce interval:"+za),za||this.startCueInterval()))},handleMouseUp:function(e){if(this.poolTable.mouseEnabled){if(this.stopCueInterval(),this.pocketSelection)return this.poolTable.mouseEnabled=!1,void this.sendPocketSelection(this.selectedPocket);this.handBall?(this.cueBall.position.x=e.offsetX,this.cueBall.position.y=e.offsetY,this.hb(e.offsetX,e.offsetY,this.canvas)):this.handBall||(this.poolTable.mouseEnabled=!1,this.stopReducerInterval(),this.sendTurn(this.cue,this.cueBall,this.canvas)),this.poolTable.mouseEnabled=!1}},isMyTurnInSnapshot:function(){return!!this.resultSnapshot&&this.resultSnapshot.payload.table.playerInTurn.name===this.userName},isHandBallPositionAllowed:function(){if(!this.firstTurnPlayed&&this.mouseCoordsTemp.x>.25*this.canvas.width)return!1;if(!(this.mouseCoordsTemp.x>this.poolTable.leftPart.a+this.cueBall.radius&&this.mouseCoordsTemp.x<this.poolTable.rightPart.a-this.cueBall.radius))return!1;if(!(this.mouseCoordsTemp.y>this.poolTable.topLeftPart.a+this.cueBall.radius&&this.mouseCoordsTemp.y<this.poolTable.bottomRightPart.a-this.cueBall.radius))return!1;for(var e=0;e<this.balls.length;e++){var t=this.balls[e];if(0!==t.number){var n=t.position.x-this.cueBall.position.x,a=t.position.y-this.cueBall.position.y;if(!(Math.abs(n)>t.diameter)&&!(Math.abs(a)>t.diameter))return!1}}return!0},handleMouseMove:function(e){var t=this;if(this.poolTable.mouseEnabled){if(this.mouseCoordsTemp={x:e.offsetX,y:e.offsetY},this.pocketSelection)return this.selectedPocket=this.getClosestPocket(e),void this.draw();this.handBall?(this.cueBall.position.x=e.offsetX,this.cueBall.position.y=e.offsetY,setTimeout((function(){t.isHandBallPositionAllowed(e)?t.cueBall.image.visible=!0:t.cueBall.image.visible=!1,t.draw()}),10)):(this.cue.position.x=this.cueBall.position.x,this.cue.position.y=this.cueBall.position.y,this.mousePoint={x:e.offsetX,y:e.offsetY},this.isMyTurnInStore()&&setTimeout((function(){t.updateCueAngle(e),t.draw()}),150))}},handleAfterAnimation:function(){var e=this;return new Promise((function(t){e.isMyTurnInStore()&&null!==e.theTable.playerInTurn&&(e.cue.force=0),e.draw(),t("resolve after animation")}))},shootBall:function(e){var t=this;return new Promise((function(n){t.cue.force<10&&(t.cue.force=10);var a={x:-Ha-$a/2,y:-Va/2};t.cue.force=e.cue.force,t.cue.angle=e.cue.angle,t.cue.image.canvasRotationAngle=e.cue.angle,t.cue.image.canvasDestination=a,t.cueBall.velocity={x:t.cue.force*Math.cos(t.cue.image.canvasRotationAngle),y:t.cue.force*Math.sin(t.cue.image.canvasRotationAngle)},t.collideCueWithCueBall().then((function(){t.playingTurn=!0,t.handleCollisions().then((function(){t.handleAfterAnimation().then((function(){n("animations done")}))}))}))}))},collideCueWithCueBall:function(){var e=this;return new Promise((function(t){e.cue.position=e.cueBall.position,setTimeout((function(){e.draw(),t("Cue movement done")}),145)}))},handleCollisions:function(){var e=this;return new Promise((function(t){Wa=setInterval((function(){e.updateBallProperties(),e.handleBallCollisions(),e.draw(),e.isAnyBallMoving()||(clearInterval(Wa),t("collisions checked"))}),25)}))},updateBallProperties:function(){for(var e=0;e<this.balls.length;e++){var t=this.balls[e];t.inPocket?t.velocity={x:0,y:0}:(t.position.x+=t.velocity.x*qa,t.position.y+=t.velocity.y*qa,t.velocity.x*=Ua,t.velocity.y*=Ua)}},checkIfGoesToPocket:function(e){var t=this.poolTable.pockets[0],n=Math.pow(e.position.x-t.center.x,2)+Math.pow(e.position.y-t.center.y,2)<=Math.pow(t.radius,2);return n?t:(t=this.poolTable.topMiddlePocket,n=Math.pow(e.position.x-t.center.x,2)+Math.pow(e.position.y-t.center.y,2)<=Math.pow(t.radius,2),n?t:(t=this.poolTable.topRightPocket,n=Math.pow(e.position.x-t.center.x,2)+Math.pow(e.position.y-t.center.y,2)<=Math.pow(t.radius,2),n?t:(t=this.poolTable.bottomRightPocket,n=Math.pow(e.position.x-t.center.x,2)+Math.pow(e.position.y-t.center.y,2)<=Math.pow(t.radius,2),n?t:(t=this.poolTable.bottomMiddlePocket,n=Math.pow(e.position.x-t.center.x,2)+Math.pow(e.position.y-t.center.y,2)<=Math.pow(t.radius,2),n?t:(t=this.poolTable.bottomLeftPocket,n=Math.pow(e.position.x-t.center.x,2)+Math.pow(e.position.y-t.center.y,2)<=Math.pow(t.radius,2),n?t:void 0)))))},handleBallCollisions:function(){for(var e=0;e<this.balls.length;e++){var t=this.balls[e];this.isMoving(t)&&!t.inPocket&&this.checkAndHandleTableCollision(t);for(var n=e+1;n<this.balls.length;n++){var a=this.balls[n],i=this.balls[e];a.inPocket||i.inPocket||(this.isMoving(a)||this.isMoving(i))&&this.checkAndHandleCollision(i,a)}}},checkAndHandleCollision:function(e,t){var n=this.subtractVectors(e.position,t.position),a=this.calculateLength(n);if(!(a>this.cueBall.diameter)){var i=this.multiplyVector(n,(this.cueBall.diameter-a)/a);e.position.x+=.5*i.x,e.position.y+=.5*i.y,t.position.x-=.5*i.x,t.position.y-=.5*i.y;var o=1/a,s=this.multiplyVector(n,o),r={x:-s.y,y:s.x},l=this.dotProduct(s,e.velocity),c=this.dotProduct(r,e.velocity),u=this.dotProduct(s,t.velocity),h=this.dotProduct(r,t.velocity),d=u,p=l;d={x:s.x*d,y:s.y*d};var m={x:r.x*c,y:r.y*c};p={x:s.x*p,y:s.y*p};var g={x:r.x*h,y:r.y*h};e.velocity={x:d.x+m.x,y:d.y+m.y},t.velocity={x:p.x+g.x,y:p.y+g.y}}},isMoving:function(e){return!!e&&(0!==e.velocity.x||0!==e.velocity.y)},checkAndHandleTableCollision:function(e){var t=this;if(!this.isBallInMiddleArea(e))if(this.isTableTopBoundry(e))e.velocity.y=Math.abs(e.velocity.y);else if(this.isTableBottomBoundry(e))e.velocity.y=-Math.abs(e.velocity.y);else if(this.isTableLeftBoundry(e))e.velocity.x=Math.abs(e.velocity.x);else if(this.isTableRightBoundry(e))e.velocity.x=-Math.abs(e.velocity.x);else if(this.checkAndHandlePocketPathwayCollisions(e));else{var n=this.checkIfGoesToPocket(e);if(n)return this.putBallInMiddleOfPocket(e,n),void setTimeout((function(){t.movePocketedBallToEdgeOfTable(e),t.draw()}),1500)}},updatePositionAndVelocity:function(e){e.position.x+=e.velocity.x*qa,e.position.y+=e.velocity.y*qa,e.velocity.x*=Ua,e.velocity.y*=Ua},checkAndHandlePocketPathwayCollisions:function(e){for(var t=0;t<this.poolTable.pockets.length;t++){var n=this.poolTable.pockets[t];if(this.isPathwayBorderCollision(n.pathwayRight,e,t)){var a=this.calculateBallVelocityOnPathwayBorderCollision(n.pathwayRight,e);return e.velocity=a,!0}if(this.isPathwayBorderCollision(n.pathwayLeft,e,t)){var i=this.calculateBallVelocityOnPathwayBorderCollision(n.pathwayLeft,e);return e.velocity=i,!0}}return!1},calculateBallVelocityOnPathwayBorderCollision:function(e,t){var n=this.subtractVectors(e.bottom,e.top),a=this.calculateLength(n),i=1/a,o=this.multiplyVector(n,i),s=2*this.dotProduct(o,t.velocity),r=this.multiplyVector(o,s),l=this.subtractVectors(r,t.velocity);return l},isPathwayBorderCollision:function(e,t){if(this.isBallInMiddleArea(t))return!1;var n=e.top,a=e.bottom,i=t.position,o=this.subtractVectors(i,n),s=this.subtractVectors(a,n),r=this.addVectors(this.projectVectorOnVector(o,s),n),l=this.subtractVectors(r,n),c=Math.abs(s.x)>Math.abs(s.y)?l.x/s.x:l.y/s.y,u=void 0;return c<=0?u=Math.sqrt(this.hypot2(i,n)):c>=1&&(u=Math.sqrt(this.hypot2(i,a))),u||(u=Math.sqrt(this.hypot2(i,r))),u<=t.radius},isBallInMiddleArea:function(e){var t={x:125,y:130},n={x:1072,y:550},a=this.subtractVectors(e.position,t),i=this.subtractVectors(n,e.position);if(a.x>0&&a.y>0)return i.x>0&&i.y>0},hypot2:function(e,t){return this.dotProduct(this.subtractVectors(e,t),this.subtractVectors(e,t))},projectVectorOnVector:function(e,t){var n=this.dotProduct(e,t)/this.dotProduct(t,t);return{x:n*t.x,y:n*t.y}},calculateLength:function(e){var t=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));return t},calculateVectorLength:function(e){var t=Math.sqrt(Math.pow(e.velocity.x,2)+Math.pow(e.velocity.y,2));return t<5&&(e.velocity={x:0,y:0}),e},multiplyVector:function(e,t){return{x:e.x*t,y:e.y*t}},addVectors:function(e,t){return{x:e.x+t.x,y:e.y+t.y}},subtractVectors:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},dotProduct:function(e,t){return e.x*t.x+e.y*t.y},isAnyBallMoving:function(){for(var e=0;e<this.balls.length;e++){var t=this.balls[e];if(this.calculateVectorLength(t),0!==t.velocity.x||0!==t.velocity.y)return!0}return!1},updateCueAngle:function(e){var t=this.mousePoint.y-this.cueBall.position.y,n=this.mousePoint.x-this.cueBall.position.x,a=Math.atan2(t,n);this.cue.angle=a,this.cue.image.canvasRotationAngle=a,this.t(this.sp,1e3,this.cue,this.cueBall,this.canvas)},updateCueForce:function(){this.cue.force+=10,this.cue.image.canvasDestination.x-=5,this.draw(),this.cue.force>=250&&(this.stopCueInterval(),this.stopReducerInterval(),this.poolTable.mouseEnabled=!1,this.sendTurn(this.cue,this.cueBall,this.canvas))},updatePointerLine:function(e){if(e){var t=this.cueBall;this.pointerLine={fromX:t.position.x+t.diameter/2,fromY:t.position.y+t.diameter/2,toX:e.offsetX,toY:e.offsetY}}},calculateBallColor:function(e){return 8===e?"black":e%2===0?"red":"yellow"},calculateRackRow:function(e){return 1===e||8===e||13==e?0:3===e||15===e?1:10===e||2===e||15===e?-1:4===e||12===e?-2:6===e||14===e?2:7===e?3:9===e?-3:5===e?-4:11===e?4:-4},calculateRackColumn:function(e){return 1===e?1:10===e||3===e?2:4===e||8===e||14===e?3:7===e||9===e||2===e||15===e?4:5},repaintTableParts:function(e){this.renderingContext.moveTo(this.poolTable.leftPart.a,this.poolTable.leftPart.b),this.renderingContext.lineTo(this.poolTable.leftPart.a,this.poolTable.leftPart.c),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.moveTo(this.poolTable.topLeftPart.b,this.poolTable.topLeftPart.a),this.renderingContext.lineTo(this.poolTable.topLeftPart.c,this.poolTable.topLeftPart.a),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.moveTo(this.poolTable.topRightPart.b,this.poolTable.topRightPart.a),this.renderingContext.lineTo(this.poolTable.topRightPart.c,this.poolTable.topRightPart.a),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.moveTo(this.poolTable.rightPart.a,this.poolTable.rightPart.b),this.renderingContext.lineTo(this.poolTable.rightPart.a,this.poolTable.rightPart.c),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.moveTo(this.poolTable.bottomRightPart.b,this.poolTable.bottomRightPart.a),this.renderingContext.lineTo(this.poolTable.bottomRightPart.c,this.poolTable.bottomRightPart.a),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.moveTo(this.poolTable.bottomLeftPart.b,this.poolTable.bottomLeftPart.a),this.renderingContext.lineTo(this.poolTable.bottomLeftPart.c,this.poolTable.bottomLeftPart.a),this.renderingContext.stroke(),this.renderingContext.closePath()},repaintPockets:function(){this.renderingContext.fillStyle="red",this.renderingContext.lineWidth=1,this.renderingContext.beginPath(),this.renderingContext.arc(this.poolTable.pockets[0].center.x,this.poolTable.pockets[0].center.y,this.poolTable.pockets[0].radius,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.fill(),this.renderingContext.beginPath(),this.renderingContext.arc(this.poolTable.topMiddlePocket.center.x,this.poolTable.topMiddlePocket.center.y,this.poolTable.topMiddlePocket.radius,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.fill(),this.renderingContext.beginPath(),this.renderingContext.arc(this.poolTable.topRightPocket.center.x,this.poolTable.topRightPocket.center.y,this.poolTable.topRightPocket.radius,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.fill(),this.renderingContext.beginPath(),this.renderingContext.arc(this.poolTable.bottomRightPocket.center.x,this.poolTable.bottomRightPocket.center.y,this.poolTable.bottomRightPocket.radius,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.fill(),this.renderingContext.beginPath(),this.renderingContext.arc(this.poolTable.bottomMiddlePocket.center.x,this.poolTable.bottomMiddlePocket.center.y,this.poolTable.bottomMiddlePocket.radius,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.fill(),this.renderingContext.beginPath(),this.renderingContext.arc(this.poolTable.bottomLeftPocket.center.x,this.poolTable.bottomLeftPocket.center.y,this.poolTable.bottomLeftPocket.radius,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.fill()},repaintPathways:function(){this.mouseCoordsTemp&&(this.renderingContext.fillStyle="black",this.renderingContext.fillText("Mouse: x:"+this.mouseCoordsTemp.x+"  y:"+this.mouseCoordsTemp.y,150,50),this.renderingContext.fillText("Ball:  x:"+this.cueBall.position.x+"  y:"+this.cueBall.position.y,150,40));for(var e=0;e<6;e++){var t=this.poolTable.pockets[e].pathwayLeft;if(!t)break;this.renderingContext.moveTo(t.top.x,t.top.y),this.renderingContext.lineTo(t.bottom.x,t.bottom.y),this.renderingContext.stroke(),this.renderingContext.closePath(),t=this.poolTable.pockets[e].pathwayRight,this.renderingContext.moveTo(t.top.x,t.top.y),this.renderingContext.lineTo(t.bottom.x,t.bottom.y),this.renderingContext.stroke(),this.renderingContext.closePath()}},repaintNames:function(){this.renderingContext.font="bolder 16px Arial",this.renderingContext.fillStyle="black",this.renderingContext.fillText(this.theTable.playerA.name,.1*this.canvas.width,20),this.renderingContext.fillText(this.theTable.playerB.name,.55*this.canvas.width,20)},repaintPocketSelection:function(e){this.renderingContext.fillStyle="blue",this.renderingContext.lineWidth=1,this.renderingContext.beginPath(),this.renderingContext.arc(this.poolTable.pockets[e].center.x,this.poolTable.pockets[e].center.y,this.poolTable.pockets[e].radius,0,2*Math.PI),this.renderingContext.stroke(),this.renderingContext.closePath(),this.renderingContext.fill()}}});const Qa=(0,Q.Z)(Ya,[["render",Aa],["__scopeId","data-v-a912993e"]]);var Za=Qa,Ja={class:"row mb-3 mt-2"},Xa=(0,i.uE)('<div class="col"><span class="fw-bold"><h3>Terms and conditions 24.02.2022</h3></span><p class=""><span class="fw-bold">General</span><br> Site is under construction and can change/reset data without informing. At the moment you can play eightball, tic-tac-toe and connect4 games. On some occasions IP-address of the client is logged. <br></p><p class=""><span class="fw-bold">Cookies</span><br> This site does not use cookies to store information. Instead it uses browser&#39;s session storage to store login token.<br> With basic browser settings token is removed after closing or after using logging out functionality. <br></p><p class=""><span class="fw-bold">Browsers</span><br> Recommended browsers are latest versions of Firefox, Chrome and Edge. <br></p><p class=""><span class="fw-bold">Bugs </span><br> No bounties are available for bugs. But if you track them and find anything please use the feedback form for notifying. </p><p class=""><span class="fw-bold">Disclaimer</span><br> You use this site at your own risk.<br> There is no guarantee for this website to work error free. The author of this site is not liable for any damage what could be caused by using this website.<br></p></div>',1),ja=[Xa];function Ka(e,t,n,a,o,s){return(0,i.wg)(),(0,i.iD)("div",Ja,ja)}var ei=(0,i.aZ)({name:"Info",data:function(){return{messages:null,message:{text:""}}},computed:{messageExist:function(){return this.message.text.length>0}},created:function(){},methods:{sendMessage:function(){var e=this.message.text.trim();e.length<1||e.length}}});const ti=(0,Q.Z)(ei,[["render",Ka]]);var ni=ti,ai={class:"row"},ii=(0,i.uE)('<div class="col-xs-12 col-sm-12"><span class="fw-bold"> Eight ball briefly: </span><p> 1. Starting player sets the handball on the left side of the line by clicking the position with mouse.<br> 2. At first the table is open =&gt; players choose either solids or stripes to play with.<br> 3. Aim with mouse, put cursor near the ball you want to hit. <br> Holding mouse button down gives force to the cue, until maxed out or releasing the button.<br> 4. Last ball to put into a pocket is eight ball. A pocket selection must be done before pocketing.<br> 5. Player wins if eight ball is hit first and it goes to the selected pocket while cue ball stays on the table.<br> 6. Other than starting handball can be placed freely at the table unless it is overlapping other ball. </p><p><span class="fw-bold"> Mobile clients </span> It is possible to play the games also with mobile client. <p> Canvas, where the games are playd, is not responsive. However it is possible to zoom in and out. Playing can be easier if device supports horizontal layout by turning the device.<br> EightBall: Mobile device uses browser&#39;s pointer events which are not supported by all devices. <br> Both aiming and cue force loading happens by holding finger (or similar) on the screen at wanted point. <br> Zooming in and out _should_ be also possible before aiming has started. </p></p></div>',1),oi=[ii];function si(e,t,n,a,o,s){return(0,i.wg)(),(0,i.iD)("div",ai,oi)}var ri=(0,i.aZ)({name:"Instructions",mixins:[F],data:function(){},computed:{},created:function(){},methods:{}});const li=(0,Q.Z)(ri,[["render",si]]);var ci=li,ui=function(e){return(0,i.dD)("data-v-b491747e"),e=e(),(0,i.Cn)(),e},hi={key:0,class:"row"},di=ui((function(){return(0,i._)("div",{class:"col fw-bold"}," Have some feedback? Are games not working? Have improvement ideas? ",-1)})),pi={class:"row mt-4"},mi={class:"col"},gi=["disabled"],bi=ui((function(){return(0,i._)("div",{class:"row"},[(0,i._)("div",{class:"col"},[(0,i.Uk)(" Known issues for 8-ball game: "),(0,i._)("br"),(0,i.Uk)(" 1. On some occasions the ball which collides with cue ball can go/move to an unexpected or even opposite direction than what can be expected. "),(0,i._)("br"),(0,i.Uk)(" 2. A ball can be wobbly when it goes along the pocket pathway. "),(0,i._)("br"),(0,i._)("br"),(0,i.Uk)(" In these cases going to another browser window/tab and coming back refreshes the browser to the latest server level."),(0,i._)("br")])],-1)})),fi={key:0,class:"row d-inline-flex p-2 alert-danger"},vi={key:1,class:"row spinner-border",role:"status"},yi=ui((function(){return(0,i._)("span",{class:"sr-only"},null,-1)})),Ti=[yi],wi={key:2,class:"row mt-4 alert alert-success"},ki=ui((function(){return(0,i._)("div",{class:"col"}," Thanks! ",-1)})),xi=[ki];function Ci(e,t,n,o,s,r){return(0,i.wg)(),(0,i.iD)(i.HY,null,[e.showThanks||e.loadingData?e.loadingData?((0,i.wg)(),(0,i.iD)("div",vi,Ti)):(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",hi,[di,(0,i._)("div",pi,[(0,i._)("div",mi,[(0,i._)("div",null,[(0,i.wy)((0,i._)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.message=t}),maxlength:"400",class:"form-control",rows:"3"}," ",512),[[a.nr,e.message]]),(0,i._)("button",{disabled:!e.sendButtonEnabled,onClick:t[1]||(t[1]=function(){return e.send&&e.send.apply(e,arguments)}),class:"btn btn-primary"}," Send feedback ",8,gi)])])]),bi,e.showError?((0,i.wg)(),(0,i.iD)("div",fi," Error occured! ")):(0,i.kq)("",!0)])),e.showThanks?((0,i.wg)(),(0,i.iD)("div",wi,xi)):(0,i.kq)("",!0)],64)}var Pi=(0,i.aZ)({name:"Feedback",data:function(){return{message:"",error:!1,success:!1,loading:!1}},computed:{sendButtonEnabled:function(){var e=this.message.trim();return e.length>4},showError:function(){return this.error},showThanks:function(){return this.success},loadingData:function(){return this.loading}},methods:{send:function(){var e=this;console.log("http://35.217.7.146");var t="http://35.217.7.146/portal/api/feedback",n={method:"POST",headers:{"Content-Type":"application/json",Authorization:null},body:JSON.stringify(this.message)};this.loading=!0,fetch(t,n).then((function(e){if(200!==e.status)return Promise.reject("error in feedback")})).then((function(t){e.error=!1,e.success=!0,e.message=""}),(function(t){e.error=!0,e.success=!1})).finally((function(){e.loading=!1}))}},created:function(){}});const Bi=(0,Q.Z)(Pi,[["render",Ci],["__scopeId","data-v-b491747e"]]);var Si=Bi,Ii={key:0,class:"row"},_i=(0,i._)("div",{class:"col"},[(0,i._)("h3",null," Create nickname")],-1),Li=(0,i._)("div",{class:"row"},[(0,i._)("div",{class:"col m-2"}," Nickname is optional to play the game. Nickname must be at least 2 chars and must not contain special characters. Password must be at minimum 8 characters. ")],-1),Di=[_i,Li],Ri={key:1,class:"row"},Mi={class:"col m-2"},Ai=(0,i.Uk)(" * Nickname "),Ni={key:2,class:"row"},Ei={class:"col"},Oi=(0,i.Uk)(" * Password "),Gi={key:3,class:"row"},Hi={class:"col"},Vi=["disabled"],$i={key:0,class:"text-danger"},Ui={key:0,class:"d-inline-flex p-2 alert-danger",role:"alert"},qi={key:1,class:"d-inline-flex p-2 alert-danger",role:"alert"},zi={key:4,class:"row"},Wi={class:"col alert alert-success"},Fi=(0,i.Uk)(" login ");function Yi(e,t,n,o,s,r){var l=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)(i.HY,null,[e.registerDone?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Ii,Di)),e.registerDone?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Ri,[(0,i._)("div",Mi,[Ai,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.usrNameTemp=t}),class:"p-3",id:"username",type:"text",name:"username",pattern:"\\\\S(.\\\\*\\\\S)\\\\?\\\\*",title:"This field is required",size:"40",maxlength:"15",autocomplete:"off"},null,512),[[a.nr,e.usrNameTemp]])])])),e.registerDone?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Ni,[(0,i._)("div",Ei,[Oi,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.usrPwTemp=t}),class:"p-3",id:"pw",name:"pw",type:"password",minlength:"8",size:"40",maxlength:"150",autocomplete:"off"},null,512),[[a.nr,e.usrPwTemp]])])])),e.registerDone?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Gi,[(0,i._)("div",Hi,[(0,i._)("button",{onClick:t[2]||(t[2]=function(){return e.registrate&&e.registrate.apply(e,arguments)}),class:"btn btn-primary",disabled:e.isRegistrateButtonDisabled}," Registrate ",8,Vi),e.registrationDataOk?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("span",$i," Type (better) password"))]),e.errorInRegistration?((0,i.wg)(),(0,i.iD)("div",Ui," Registration error occured! Nickname minimum 2 characters and password minimum 8 characters. Try another nickname. ")):(0,i.kq)("",!0),e.errorInRegistrationDuplicate?((0,i.wg)(),(0,i.iD)("div",qi,"Oops, seems like nickname is already taken, try another.")):(0,i.kq)("",!0)])),e.registerDone?((0,i.wg)(),(0,i.iD)("div",zi,[(0,i._)("div",Wi,[(0,i.Uk)(" Registration for nickname "+(0,u.zw)(e.usrNameTemp)+" is complete. You can now ",1),(0,i.Wm)(l,{to:{name:"Login"}},{default:(0,i.w5)((function(){return[Fi]})),_:1})])])):(0,i.kq)("",!0)],64)}n(7852);var Qi=(0,i.aZ)({name:"Registration",data:function(){return{usrNameTemp:null,usrPwTemp:null,registerError:null,registerErrorNickName:null,requestOnTheFly:!1,registerDone:!1}},computed:{isRegistrateButtonDisabled:function(){return!!this.requestOnTheFly||!this.registrationDataOk},errorInRegistration:function(){return null!=this.registerError},errorInRegistrationDuplicate:function(){return null!=this.registerErrorNickName},registrationDataOk:function(){return!(!this.usrPwTemp||!this.usrNameTemp)&&(this.usrPwTemp!==this.usrNameTemp&&(!this.usrPwTemp.startsWith("1234567")&&(!this.usrPwTemp.startsWith("qwerty")&&(!this.usrPwTemp.startsWith(" ")&&!this.usrPwTemp.endsWith(" ")&&(!(this.usrPwTemp.length<8)&&!(this.usrNameTemp.length<1))))))}},created:function(){},methods:{showLogin:function(){},registrate:function(){var e,t=this;this.registerError=null,this.registerErrorNickName=null,this.requestOnTheFly=!0;var n={method:"POST",headers:{"Content-Type":"application/json",Authorization:null},body:JSON.stringify({userName:null===(e=this.usrNameTemp)||void 0===e?void 0:e.trim(),password:this.usrPwTemp.trim()})},a="http://35.217.7.146/portal/api/user/register";this.$store.dispatch("setLoadingStatus",!0),fetch(a,n).then((function(e){return t.resetRegistrationData(),406===e.status?Promise.reject(406):200!==e.status?Promise.reject("error in login"):e.json()})).then((function(e){t.usrNameTemp=e.name,t.registerDone=!0}),(function(e){406===e?t.registerErrorNickName=!0:t.registerError=!0})).finally((function(){t.requestOnTheFly=!1,t.$store.dispatch("setLoadingStatus",!1)}))},resetRegistrationData:function(){this.usrNameTemp=null,this.usrPwTemp=null}}});const Zi=(0,Q.Z)(Qi,[["render",Yi]]);var Ji=Zi,Xi={class:"row"},ji={class:"col text-danger"},Ki=(0,i.Uk)(" An error occured. Try navigating to "),eo=(0,i.Uk)("main page");function to(e,t,n,a,o,s){var r=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",Xi,[(0,i._)("div",ji,[Ki,(0,i.Wm)(r,{to:{name:"Home"}},{default:(0,i.w5)((function(){return[eo]})),_:1})])])}var no=(0,i.aZ)({name:"Error",methods:{toMainPage:function(){this.$router.push("/")}},created:function(){}});const ao=(0,Q.Z)(no,[["render",to]]);var io=ao,oo=n(8637),so=(0,oo.MT)({state:{user:null,games:[],tables:[],users:[],theTable:null,commonChat:{messages:[],message:null},loadingStatus:!1},getters:{user:function(e){if(e.user)return e.user;var t=sessionStorage.getItem("userName"),n=sessionStorage.getItem("token");if(t&&n){var a={name:t,token:n};return so.dispatch("setUser",a),e.user}return null},loading:function(e){return e.loadingStatus},userName:function(e){return e.user?e.user.name:null},users:function(e){return e.users},tables:function(e){return e.tables},games:function(e){return e.games},theTable:function(e){return e.theTable},chatMessages:function(e){return e.theTable&&e.theTable.chat?e.theTable.chat.messages:[]},commonChatMessages:function(e){return e.commonChat.messages},gameBoard:function(e){return e.theTable.board},loadingStatus:function(e){return e.loadingStatus},playerInTurn:function(e){return e.theTable.playerInTurn}},mutations:{setUser:function(e,t){t?(sessionStorage.setItem("userName",t.name),sessionStorage.setItem("token",t.token),e.user=t):(sessionStorage.removeItem("userName"),sessionStorage.removeItem("token"),e.user=t)},setGames:function(e,t){e.games=t},setTables:function(e,t){e.tables=t},clearTable:function(e){e.theTable=null},setUsers:function(e,t){e.users=t},updateScore:function(e,t){e.theTable&&(e.theTable.playerA.wins=t.winsA,e.theTable.playerB.wins=t.winsB,e.theTable.playerInTurn=null)},addTable:function(e,t){t.playerA.name===e.user.name?e.tables.unshift(t):e.tables.push(t)},removeFromPlayerList:function(e,t){e.users=e.users.filter((function(e){return e.name!==t.name}))},removeTable:function(e,t){e.tables=e.tables.filter((function(e){return e.tableId!==t.tableId}))},addPlayer:function(e,t){e.users.push(t)},startGame:function(e,t){var n=e.tables.findIndex((function(e){return e.tableId===t.tableId}));e.tables.splice(n,1,t)},selectTable:function(e,t){var n={messages:[],message:{text:""}};t.chat=n;var a=t.board;t.board=a,e.theTable=t},addWatcher:function(e,t){if(e.theTable){var n=t.name.concat(" joined to watch"),a={from:"System",text:n};e.theTable.chat.messages.unshift(a)}},move:function(e,t){e.theTable.board.push(t)},changeTurn:function(e,t){e.theTable=(0,Na.Z)((0,Na.Z)({},e.theTable),{},{playerInTurn:t})},chat:function(e,t){e.theTable&&e.theTable.chat.messages.unshift(t)},updateCommonChat:function(e,t){e.commonChat.messages.unshift(t)},resign:function(e,t){e.theTable&&(e.theTable.playerA.wins=t.winsA,e.theTable.playerB.wins=t.winsB,e.theTable.playerInTurn=null)},leaveTable:function(e,t){if(e.theTable){(e.theTable.playerA.name===t||e.theTable.playerB.name===t)&&(e.theTable.playerInTurn=null);var n=t.concat(" left table"),a={from:"System",text:n};e.theTable.chat.messages.unshift(a)}},rematch:function(e,t){var n={messages:[],message:{text:""}};e.theTable&&e.theTable.chat&&(n=e.theTable.chat);var a={text:"Rematch started",from:"System"};n.messages.unshift(a),t.playerA.wins=t.playerA.wins,t.playerB.wins=t.playerB.wins,t.chat=n,e.theTable=t},updateWinner:function(e,t){if(this.state.theTable){e.theTable.playerInTurn=null;var n={text:t.winner.name.concat(" won"),from:"System"};e.theTable.chat.messages.unshift(n),e.theTable.win=t}},setDraw:function(e,t){if(this.state.theTable){e.theTable.playerA&&(e.theTable.playerA.draws=t.table.playerA.draws),e.theTable.playerB&&(e.theTable.playerB.draws=t.table.playerB.draws),e.theTable.playerInTurn&&(e.theTable.playerInTurn=null);var n={text:"Game ended in draw",from:"System"};e.theTable.chat.messages.unshift(n)}},setLoadingStatus:function(e,t){e.loadingStatus=t}},actions:{poolUpdate:function(e,t){},poolPlayTurn:function(e,t){},poolSetHandBall:function(e,t){},poolSelectPocket:function(e,t){},poolSetHandBallFail:function(e,t){},poolGameEnded:function(e,t){},setUser:function(e,t){e.commit("setUser",t)},setGames:function(e,t){e.commit("setGames",t)},setTables:function(e,t){e.commit("setTables",t)},setUsers:function(e,t){e.commit("setUsers",t)},addTable:function(e,t){e.commit("addTable",t)},removePlayer:function(e,t){e.commit("removeFromPlayerList",t)},removeTable:function(e,t){e.commit("removeTable",t)},addPlayer:function(e,t){e.commit("addPlayer",t)},startGame:function(e,t){e.commit("startGame",t)},selectTable:function(e,t){e.commit("selectTable",t)},addWatcher:function(e,t){e.commit("addWatcher",t)},move:function(e,t){e.commit("move",t)},changeTurn:function(e,t){e.commit("changeTurn",t)},chat:function(e,t){e.commit("chat",t)},updateCommonChat:function(e,t){e.commit("updateCommonChat",t)},resign:function(e,t){e.commit("resign",t)},updateScore:function(e,t){e.commit("updateScore",t)},rematch:function(e,t){e.commit("rematch",t)},clearTable:function(e){e.commit("clearTable")},leaveTable:function(e,t){e.state.theTable&&t.table&&e.state.theTable.tableId===t.table.tableId&&e.commit("leaveTable",t.who.name)},updateWinner:function(e,t){e.commit("updateWinner",t)},setDraw:function(e,t){e.commit("setDraw",t)},logout:function(e,t){e.commit("setTables",[]),e.commit("setUsers",[]),t&&t.webSocket&&(t.webSocket.close(),t.webSocket=null);var n={method:"POST",headers:{"Content-Type":"application/json",Authorization:null},body:JSON.stringify({token:null===t||void 0===t?void 0:t.token})},a="http://35.217.7.146/portal/api/user/logout";e.commit("setUser",null),fetch(a,n).then((function(e){}))},setLoadingStatus:function(e,t){e.commit("setLoadingStatus",t)}}}),ro=n(2119),lo=[{path:"/portal/index.html",redirect:{name:"Home"}},{path:"/index.html",redirect:{name:"Home"}},{path:"/",redirect:{name:"Home"}},{path:"/portal",redirect:{name:"Home"}},{path:"/portal/home",component:Mt,name:"Home"},{path:"/portal/instructions",component:ci,name:"Instructions"},{path:"/portal/login",component:fe,name:"Login",props:!0},{path:"/portal/registration",component:Ji,name:"Registration",props:!0},{path:"/portal/toplists",component:Yn,name:"TopLists",props:!0},{path:"/portal/lobby",component:It,name:"Lobby",props:!0,beforeEnter:function(e,t,n){if(so.state.user)n();else{var a=sessionStorage.getItem("userName"),i=sessionStorage.getItem("token"),o={name:a,token:i,webSocket:null};so.dispatch("setUser",o).then((function(){n()}))}}},{path:"/portal/table/:watch?",component:cn,name:"TableTicTacToe",props:!0,beforeEnter:function(e,t,n){so.state.user&&so.state.theTable?n():n("/")}},{path:"/portal/connectfour/:watch?",component:fa,name:"TableConnectFour",beforeEnter:function(e,t,n){so.state.user&&so.state.theTable?n():n("/")}},{path:"/portal/pool/:watch?",component:Za,name:"PoolTable",props:!0,beforeEnter:function(e,t,n){so.state.user&&so.state.theTable?n():n("/")}},{path:"/portal/user/:selectedName/profile",component:Rn,name:"Profile",props:!0},{path:"/portal/terms",component:ni,name:"Info"},{path:"/portal/feedback",component:Si,name:"Feedback"},{path:"/portal/:catchAll(.*)",component:io,name:"Error",props:!0}],co=(0,ro.p7)({history:(0,ro.PO)(),routes:lo}),uo=(0,a.ri)(K);uo.use(co).use(so).mount("#app")}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,a,i,o){if(!a){var s=1/0;for(u=0;u<e.length;u++){a=e[u][0],i=e[u][1],o=e[u][2];for(var r=!0,l=0;l<a.length;l++)(!1&o||s>=o)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(r=!1,o<s&&(s=o));if(r){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,i,o]}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,o,s=a[0],r=a[1],l=a[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(l)var u=l(n)}for(t&&t(a);c<s.length;c++)o=s[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},a=self["webpackChunktauhka_games"]=self["webpackChunktauhka_games"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(1707)}));a=n.O(a)})();